import{Ga as oe,b as Oe,d as Ue,ea as ye,ia as Ne,va as Ae}from"./chunk-HHG3VCLH.js";var a=Oe(Ue(),1);var Fe=({className:n=""})=>a.default.createElement("svg",{viewBox:"0 0 448 512",className:n,fill:"currentColor","aria-hidden":"true",focusable:"false"},a.default.createElement("path",{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-221.7 99.3-221.7 221.7 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 69 27 106.1 27h.1c122.3 0 221.7-99.3 221.7-221.7 0-59.3-23.1-115-64.7-157.3zM223.9 438.7h-.1c-33.1 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3 18.6-68-4.3-7c-18.5-29.4-28.2-63.4-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 54 81.2 54 130.4-.1 101.8-82.9 184.6-184.5 184.6zm101.1-138.2c-5.5-2.8-32.8-16.1-37.9-17.9-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 17.9-17.5 21.6-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.7 35.2 15.2 49 16.5 66.6 14 10.7-1.6 32.8-13.4 37.4-26.3 4.6-12.9 4.6-23.9 3.2-26.3-1.3-2.4-5-3.7-10.5-6.5z"})),Qe=({product:n,onAdd:j})=>{let[k,z]=(0,a.useState)(1),D=n.basePrice*(1-(n.discount||0)/100);return a.default.createElement("div",{className:"min-w-[200px] max-w-[200px] bg-[#1a1a1a] rounded-2xl border border-white/5 overflow-hidden flex flex-col group snap-center"},a.default.createElement("div",{className:"relative aspect-square bg-white/95 p-2 overflow-hidden rounded-t-2xl"},a.default.createElement("img",{src:n.image,className:"w-full h-full object-cover rounded-xl group-hover:scale-110 transition duration-500",alt:n.name,loading:"lazy"}),n.discount>0&&a.default.createElement("div",{className:"absolute top-2 left-2 bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg"},"-",n.discount,"%")),a.default.createElement("div",{className:"p-3 flex-1 flex flex-col"},a.default.createElement("h4",{className:"text-white font-bold text-xs line-clamp-2 mb-2 leading-tight h-8"},n.name),a.default.createElement("div",{className:"mt-auto"},a.default.createElement("div",{className:"flex items-center gap-2 mb-3"},a.default.createElement("span",{className:"text-yellow-500 font-black text-sm"},"$",Math.round(D).toLocaleString()),n.discount>0&&a.default.createElement("span",{className:"text-slate-500 text-[10px] line-through"},"$",(Number(n.basePrice)||0).toLocaleString())),a.default.createElement("div",{className:"flex items-center gap-2"},a.default.createElement("div",{className:"flex bg-black/40 rounded-lg border border-white/5 overflow-hidden"},a.default.createElement("button",{onClick:()=>z(Math.max(1,k-1)),className:"px-2 py-1 text-slate-400 hover:text-white hover:bg-white/5 transition"},"-"),a.default.createElement("span",{className:"px-2 py-1 text-xs text-white font-bold min-w-[24px] text-center"},k),a.default.createElement("button",{onClick:()=>z(Math.min(Number(n.stock)||1,k+1)),className:"px-2 py-1 text-slate-400 hover:text-white hover:bg-white/5 transition"},"+")),a.default.createElement("button",{onClick:()=>j(n,k),className:"flex-1 bg-yellow-600 hover:bg-yellow-500 text-white py-1.5 rounded-lg text-[10px] font-black transition flex items-center justify-center gap-1 shadow-lg shadow-yellow-900/20"},a.default.createElement(ye,{className:"w-3 h-3"})," LISTO")))))},We=a.default.memo(({settings:n,products:j,addToCart:k,controlPanel:z,coupons:D,appId:ke})=>{if(!(()=>{try{return String(window.location.href||"").includes("sustia=1")?!0:new URLSearchParams(window.location.search).get("sustia")==="1"}catch{return!1}})()&&n?.subscriptionPlan!=="premium")return null;let[_,te]=(0,a.useState)(!1),[Q,re]=(0,a.useState)(!1),W=String(n?.botImage||"").trim(),se=W&&!/sustia-ai-v2\.jpg$/i.test(W)?W:"sustia-ai.jpg",$e=`sustore_sustia_chat_${ke}`,ne={role:"model",text:"Â¡Hola! Soy SustIA ðŸ¤–, tu asistente personal. Â¿Buscas algo especial hoy? Puedo verificar stock y agregar productos a tu carrito."},[M,C]=(0,a.useState)([ne]),[H,ie]=(0,a.useState)(""),[le,ce]=(0,a.useState)(!1),S=(0,a.useRef)(null),ue=(0,a.useRef)(null),de=(0,a.useRef)(M),V=(0,a.useRef)(!1),G=(0,a.useRef)(null),K=(0,a.useRef)(!0),A=Array.isArray(j)?j:[],Se=Array.isArray(D)?D:[];(0,a.useEffect)(()=>{let t=()=>{try{re(document?.documentElement?.classList?.contains("dark-mode")===!0)}catch{re(!1)}};t();let i;try{i=new MutationObserver(()=>t()),document?.documentElement&&i.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}catch{}return()=>{try{i?.disconnect?.()}catch{}}},[]);let v=t=>t==null?"":String(t).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),Pe=t=>{let i=v(t);if(!i)return[];let o=i.split(/[\s,.;:!?/()\\[\]{}"â€œâ€'â€™\-+*_]+/).filter(Boolean),m=new Set(["el","la","los","las","un","una","unos","unas","de","del","en","con","sin","para","por","a","al","que","como","cual","cuales","donde","cuando","quien","quienes","hola","buenas","buenos","dia","dias","tardes","noches","busco","buscar","tenes","tienes","precio","vale","cuesta","quiero","necesito","hay","me","te","mi","mis","tu","tus","agrega","agregar","agregame","agregalo","sumar","sumame","poner","pone","comprar","compralo","llevo","carrito","bolsa","cesta","mas","menos","muy","super","re"]);return o.filter(c=>c.length>1&&!m.has(c)&&!/^\d+$/.test(c))},X=(t,i)=>{if(!t)return null;let o=parseFloat(String(t).replace(",","."));return Number.isFinite(o)?i.includes(`${t}k`)||i.includes(`${t} k`)||i.includes(`${t}mil`)||i.includes(`${t} mil`)?o*1e3:o:null},je=t=>{let i=v(t),o=i.match(/\b(?:x|por)\s*(\d{1,3})\b/);if(o)return Math.max(1,Math.min(99,parseInt(o[1],10)));let m=i.match(/\b(\d{1,3})\s*(?:u|ud|uds|unidad|unidades|pcs|piezas)\b/);if(m)return Math.max(1,Math.min(99,parseInt(m[1],10)));let c=i.match(/\b(\d{1,2})\b/);return c&&i.match(/\b(agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|quiero|llevo|comprar)\b/)?Math.max(1,Math.min(99,parseInt(c[1],10))):1},T=t=>{let i=[];return Array.isArray(t?.categories)&&i.push(...t.categories),typeof t?.category=="string"&&t.category.trim()&&i.push(t.category),i.filter(Boolean).map(o=>String(o).trim()).filter(Boolean)},$=t=>{let i=Number(t?.basePrice)||0,o=Number(t?.discount)||0;return i*(1-o/100)},ze=["buenos aires","caba","capital federal","ciudad autonoma","ciudad de buenos aires","catamarca","chaco","chubut","cordoba","corrientes","entre rios","formosa","jujuy","la pampa","la rioja","mendoza","misiones","neuquen","rio negro","salta","san juan","san luis","santa cruz","santa fe","santiago del estero","tierra del fuego","tucuman"],_e=["adrogue","avellaneda","bahia blanca","banfield","bariloche","bernal","berazategui","burzaco","caleta olivia","campana","caseros","cipolletti","comodoro rivadavia","concordia","devoto","el calafate","el palomar","escobar","ezeiza","florencio varela","general roca","gualeguaychu","hurlingham","iguazu","ituzaingo","jose c paz","junin","la plata","lanus","lomas de zamora","lujan","mar del plata","marcos paz","mercedes","merlo","monte grande","moron","necochea","olavarria","parana","pergamino","pilar","pinamar","posadas","presidencia roque saenz pena","quilmes","rafaela","rawson","reconquista","resistencia","rio cuarto","rio gallegos","rosario","san fernando","san isidro","san justo","san martin","san miguel","san miguel de tucuman","san nicolas","san rafael","san salvador de jujuy","santa rosa","tandil","temperley","tigre","trelew","ushuaia","venado tuerto","villa carlos paz","villa maria","villa mercedes","wilde","zarate","gonzalez catan","virrey del pino","laferrere","rafael castillo","isidro casanova","ciudad evita","aldo bonzi","tapiales","villa luzuriaga","ramos mejia","haedo","castelar","ciudadela","liniers","mataderos","lugano","flores","caballito","almagro","boedo","palermo","belgrano","nunez","recoleta","retiro","microcentro","san telmo","la boca","barracas","constitucion","once","congreso","tribunales","villa crespo","villa urquiza","villa devoto","villa del parque","versalles","monte castro","floresta","velez sarsfield","parque chacabuco","pompeya","soldati","villa lugano","villa riachuelo","liniers","mataderos","parque avellaneda","villa luro","agronomia","chacarita","paternal","villa ortuzar","coghlan","saavedra","villa pueyrredon","parque chas","villa real","puerto madero","san cristobal","balvanera","monserrat","san nicolas barrio","olivos","martinez","acassuso","beccar","boulogne","munro","florida","vicente lopez","don torcuato","el talar","garin","grand bourg","ingeniero maschwitz","los polvorines","pablo nogues","tortuguitas","william morris","general pacheco","benavidez","nordelta","rincon de milberg","dique lujan","general rodriguez","moreno","paso del rey","trujui","francisco alvarez","la reja","guernica","alejandro korn","domselaar","san vicente","canning","esteban echeverria","el jaguel","luis guillon","longchamps","glew","claypole","almirante brown","villa gesell","miramar","necochea","tres arroyos","azul","olavarria","bragado","chivilcoy","chacabuco","pehuajo","trenque lauquen","general villegas","nueve de julio","bolivar","saladillo","lobos","canuelas","san antonio de areco","carmen de areco","capitan sarmiento","san pedro","baradero","ramallo","villa constitucion","san lorenzo","casilda","firmat","chabas","rufino","general pico","rio tercero","villa allende","unquillo","jesus maria","alta gracia","cosquin","la falda","villa giardino","dean funes","cruz del eje","bell ville","marcos juarez","laboulaye","san francisco"],Ce=[...ze,..._e],Te=new Set(["caca","culo","teta","tetas","pija","pito","mierda","puta","puto","concha","pelotudo","pelotuda","boludo","boluda","forro","forra","verga","poronga","ojete","orto","pete","garcha","cogida","cogido","coger","chupar","chuparla","chupame","chupala","mamada","mogolico","mogolica","tarado","tarada","imbecil","idiota","estupido","estupida","hdp","lcdtm","ctm","ptm","sorete","trola","trolo","gil","gila","pajero","pajera","nabo","naba","salame","bobo","boba","banana","zapallo","pichipe"]),qe=t=>{let m=v(t).split(/\s+/).filter(Boolean).filter(c=>c.length>1);return m.length===0?!0:m.every(c=>Te.has(c))},Le=t=>{let i=v(t);return i.length<2||i.length>60?!1:Ce.some(o=>o.includes(i)||i.includes(o)?!0:P(o,i)&&i.length>=3)};(0,a.useEffect)(()=>{ue.current?.scrollIntoView({behavior:"smooth"})},[M,_]),(0,a.useEffect)(()=>{de.current=M},[M]),(0,a.useEffect)(()=>()=>{K.current=!1},[]);let P=(t,i)=>{if(!i||typeof i!="string"||!t||typeof t!="string")return!1;let o=v(t),m=v(i);if(o.includes(m))return!0;let c=0,w=-1;for(let u of m){let b=o.indexOf(u,w+1);b>-1&&(c++,w=b)}return c/m.length>.75},Me=async(t,i)=>{await new Promise(e=>setTimeout(e,500+Math.random()*500));let o=v(t),m=String(t||"").trim(),c=je(o),w=S.current;w&&Date.now()-(w.ts||0)>3e5&&(S.current=null);let u=e=>{S.current={...e,ts:Date.now()}},b=()=>{S.current=null};if(o.length<=1)return S.current?{text:"No entendÃ­ bien, Â¿podÃ©s escribir un poco mÃ¡s?"}:{text:"Te leÃ­, pero me falta info ðŸ˜Š. Â¿QuÃ© estÃ¡s buscando? (ej: 'auriculares', 'zapatillas', 'envÃ­o', 'pagos')"};if(qe(t))return{text:"No entendÃ­ eso ðŸ˜…. Â¿En quÃ© puedo ayudarte? PodÃ©s preguntarme por productos, envÃ­o, pagos o cupones."};if(o.match(/\b(gracias|gracia|muchas gracias|thx|thanks)\b/)&&o.length<40)return b(),{text:"Â¡De nada! Si necesitÃ¡s algo mÃ¡s, acÃ¡ estoy ðŸ˜Š"};if(o.match(/\b(chau|adios|bye|nos vemos|hasta luego)\b/)&&o.length<30)return b(),{text:"Â¡Hasta la prÃ³xima! ðŸ‘‹ Cuando quieras, estoy acÃ¡."};if(o.match(/\b(hola|holas|buen dia|buenos dias|buenas tardes|buenas noches|buenas|hello|hi|hey|que tal|como estas|como va|todo bien)\b/)&&o.length<40)return b(),{text:"Â¡Hola! ðŸ‘‹ Â¿QuÃ© querÃ©s hacer? PodÃ©s pedirme productos, ofertas, cupones, envÃ­o, pagos o que agregue algo al carrito."};if(o.match(/\b(quien sos|que sos|que haces|sos real|sos un bot|asistente)\b/))return{text:`Soy SustIA${n?.storeName?` de **${n.storeName}**`:""}. Puedo ayudarte a encontrar productos, ver ofertas/cupones y armar el carrito mÃ¡s rÃ¡pido.`};if(z){if(o.match(/modo\s*(?:oscuro|noche|dark)/))return z.setDarkMode(!0),{text:"He activado el modo oscuro ðŸŒ™"};if(o.match(/modo\s*(?:claro|dia|light)/))return z.setDarkMode(!1),{text:"He activado el modo claro â˜€ï¸"};if(o.match(/(?:ver|abrir|ir al)\s*(?:carrito|bolsa|cesta)/))return z.openCart(),{text:"Abriendo tu carrito ðŸ›’"}}let q=!!o.match(/\b(envio|envios|entrega|delivery|domicilio|retiro|retirar|pickup|como llega|cuando llega|hacen envios|mandan)\b/),O=!!o.match(/\b(pago|pagos|tarjeta|mercado\s*pago|transferencia|cbu|alias|efectivo|como pago|formas? de pago|metodos? de pago)\b/),me=!!o.match(/\b(cupon|cupones|codigo)\b/),pe=!!o.match(/\b(descuento|descuentos|promo|promos|oferta|ofertas|rebaja|rebajas)\b/),he=!!o.match(/\b(categorias|categoria|rubros|rubro|secciones)\b/),fe=!!o.match(/\b(ayuda|soporte|contacto|human|persona|asesor|whatsapp)\b/),be=!!o.match(/\b(quienes somos|about)\b/)||!!o.match(/\b(sobre|informacion)\b/)&&!o.match(/\bsobre\s+(un|el|la|este|esta|ese|esa|esto)\b/),De=q||O||me||pe||he||fe||be;if(S.current&&!De){let e=S.current,r=!!o.match(/\b(si|sip|sep|claro|dale|bueno|yes|por favor|obvio|ok|sale|va|vamos|manda|quiero|mostrame|show)\b/),h=!!o.match(/\b(no|nah|paso|cancelar|nada|asi esta bien|despues|luego|no gracias|esta bien asi)\b/);if(e.action==="asked_location"){let d=m;if(!Le(d))return{text:"No reconozco esa ubicaciÃ³n ðŸ¤”. Decime tu ciudad o provincia de Argentina (ej: *CÃ³rdoba*, *Rosario*, *CABA*, *Mar del Plata*)."};b();let{deliveryEnabled:f,pickupEnabled:l,deliveryFee:y,freeAbove:s,pickupAddress:p}=e.data||{},x=v(p),g=v(d),ae=x&&(x.includes(g)||g.includes((x.split(",")[0]||"").trim())),N=[`ðŸ“ Para **${d}**:`];if(l&&ae?N.push(`âœ… PodÃ©s retirar en nuestro local: **${p}**.`):l&&N.push(`ðŸª Tenemos retiro en local en **${p||"direcciÃ³n a coordinar"}**, pero queda en otra zona.`),f){let F=y>0?`$${y.toLocaleString()}`:"sin costo";N.push(`ðŸšš Hacemos envÃ­os a domicilio (${F}${s>0?`, gratis superando $${s.toLocaleString()}`:""}).`),N.push(`Para confirmar costo exacto a ${d}, avanzÃ¡ al checkout o consultanos.`)}return!l&&!f&&N.push("TodavÃ­a no tenemos envÃ­o configurado. Consultanos para coordinar."),n?.whatsappLink&&N.push(`
[WSP_BUTTON]`),N.push(`
Â¿NecesitÃ¡s algo mÃ¡s? Puedo mostrarte productos, ofertas o medios de pago.`),{text:N.join(`
`)}}if(e.action==="showed_products"&&Array.isArray(e.shownProducts)&&e.shownProducts.length>0){let d=e.shownProducts,f=[{p:/\b(primero|primer|1ro|1ero|1Â°)\b/,i:0},{p:/\b(segundo|2do|2Â°)\b/,i:1},{p:/\b(tercero|tercer|3ro|3ero|3Â°)\b/,i:2},{p:/\b(cuarto|4to|4Â°)\b/,i:3},{p:/\b(ultimo|quinto|5to|5Â°)\b/,i:d.length-1}],l=null;for(let s of f)if(o.match(s.p)&&d[s.i]){l=d[s.i];break}if(!l&&o.match(/\b(ese|este|eso|esto)\b/)&&(l=d[0]),!l){let s=o.match(/\b(?:el|la|n[uÃº]mero)\s*(\d)\b/);s&&d[parseInt(s[1],10)-1]&&(l=d[parseInt(s[1],10)-1])}if(!l&&o.length>3&&(l=d.find(s=>{let p=v(s.name);return p.includes(o)||o.includes(p.split(" ")[0])})),!!o.match(/\b(agrega|agregar|agregame|agregalo|sum[aÃ¡]|sumale|pone|poner|met[eÃ©]|comprar|compralo|quiero|dame|llevo|lo quiero|al carrito|sumalo|mandalo)\b/)){let s=l||d[0];k(s,c);let p=d.filter(x=>x.id!==s.id).slice(0,3);return p.length>0?(u({action:"asked_yes_no",subAction:"cross_sell",data:p,shownProducts:p}),{text:`Â¡Listo! AgreguÃ© **${c}x ${s.name}** al carrito ðŸ›’

Â¿QuerÃ©s ver algo mÃ¡s para complementar?`,products:[s]}):(b(),{text:`Â¡Listo! AgreguÃ© **${c}x ${s.name}** al carrito ðŸ›’ Â¿Algo mÃ¡s?`,products:[s]})}if(l&&o.match(/\b(info|detalle|detalles|especif|descrip|cuenta|contame|mas sobre)\b/)){let s=l,p=$(s),x=T(s),g=[`ðŸ“¦ **${s.name}**`,`ðŸ’° $${Math.round(p).toLocaleString()}${(s.discount||0)>0?` (${s.discount}% OFF)`:""}`];return s.description&&g.push(`ðŸ“ ${String(s.description).slice(0,200)}`),x.length>0&&g.push(`ðŸ·ï¸ ${x.join(", ")}`),g.push(`ðŸ“Š Stock: ${s.stock||0} unidades`),g.push(`
Â¿Lo agregamos al carrito?`),u({action:"asked_yes_no",subAction:"add_product",data:s,shownProducts:d}),{text:g.join(`
`),products:[s]}}if(l){let s=l,p=$(s);return u({action:"asked_yes_no",subAction:"add_product",data:s,shownProducts:d}),{text:`**${s.name}** â€” $${Math.round(p).toLocaleString()}${(s.discount||0)>0?` (${s.discount}% OFF)`:""}

Â¿Lo agrego al carrito?`,products:[s]}}if(o.match(/\b(barato|economico|baratos|economicos|menor precio)\b/)){let s=[...d].sort((p,x)=>$(p)-$(x));return u({action:"showed_products",shownProducts:s,searchKeywords:e.searchKeywords}),{text:"Ordenados de mÃ¡s econÃ³mico a mÃ¡s caro:",products:s}}if(o.match(/\b(caro|caros|premium|mejor calidad|top|mejor)\b/)){let s=[...d].sort((p,x)=>$(x)-$(p));return u({action:"showed_products",shownProducts:s,searchKeywords:e.searchKeywords}),{text:"Las opciones de mayor precio/calidad:",products:s}}if(o.match(/\b(otro|otros|otras|mas opciones|ver mas|siguiente|siguientes|que mas hay|hay mas)\b/)){let s=new Set(d.map(g=>g.id)),p=A.filter(g=>!s.has(g.id)&&(Number(g.stock)||0)>0&&g.isActive!==!1);if(Array.isArray(e.searchKeywords)&&e.searchKeywords.length>0){let g=p.filter(ae=>{let N=v(ae.name);return e.searchKeywords.some(F=>N.includes(F)||P(N,F))});g.length>0&&(p=g)}let x=p.slice(0,5);return x.length>0?(u({action:"showed_products",shownProducts:x,searchKeywords:e.searchKeywords}),{text:"MÃ¡s opciones:",products:x}):{text:"No tengo mÃ¡s opciones con ese criterio. Â¿QuerÃ©s buscar otra cosa?"}}}if(e.action==="asked_yes_no"){if(r){if(b(),e.subAction==="cross_sell"&&Array.isArray(e.data))return{text:"Â¡MirÃ¡ estas opciones! ðŸ”¥",products:e.data};if(e.subAction==="show_deals"&&Array.isArray(e.data))return{text:"Las mejores ofertas ahora mismo:",products:e.data};if(e.subAction==="add_product"&&e.data)return k(e.data,c),{text:`Â¡Listo! AgreguÃ© **${c}x ${e.data.name}** al carrito ðŸ›’ Â¿Algo mÃ¡s?`,products:[e.data]}}if(h)return b(),{text:"Perfecto. Â¿NecesitÃ¡s algo mÃ¡s? ðŸ˜Š"}}if(e.action==="asked_category"){let f=[...new Set([...Array.isArray(n?.categories)?n.categories:[],...A.flatMap(l=>T(l))])].find(l=>P(v(l),o)||P(o,v(l)));if(f){let l=A.filter(y=>(Number(y.stock)||0)>0&&y.isActive!==!1&&T(y).some(s=>s.toLowerCase()===f.toLowerCase())).slice(0,5);return l.length>0?(u({action:"showed_products",shownProducts:l,searchKeywords:[]}),{text:`Productos en **${f}**:`,products:l}):{text:`No hay productos disponibles en "${f}" ahora. Â¿Buscamos otra categorÃ­a?`}}}}if(he){let e=[...new Set(A.flatMap(h=>T(h)))],r=[...new Set([...Array.isArray(n?.categories)?n.categories:[],...e])].map(h=>String(h).trim()).filter(Boolean);return r.length===0?{text:"TodavÃ­a no tengo categorÃ­as configuradas. Decime quÃ© estÃ¡s buscando y lo resuelvo igual."}:(u({action:"asked_category"}),{text:`Tenemos estas categorÃ­as:

${r.slice(0,10).map(h=>`- ${h}`).join(`
`)}

Decime cuÃ¡l te interesa y te muestro opciones.`})}if(be){let e=n?.aboutUsText||"";return e.trim()?{text:e.trim()}:{text:"Esta tienda todavÃ­a no cargÃ³ su secciÃ³n â€œSobre nosotrosâ€. Â¿QuerÃ©s que te ayude a encontrar un producto?"}}if(q){let e=!!n?.shippingDelivery?.enabled,r=!!n?.shippingPickup?.enabled,h=Number(n?.shippingDelivery?.fee)||0,d=Number(n?.shippingDelivery?.freeAbove)||0,f=n?.shippingPickup?.address||"",l=[];return r&&l.push(`ðŸ“ Retiro en local: ${f?`**${f}**`:"a coordinar"}.`),e&&(d>0?l.push(`ðŸšš EnvÃ­o a domicilio: $${h.toLocaleString()} (gratis desde $${d.toLocaleString()}).`):l.push(`ðŸšš EnvÃ­o a domicilio: $${h.toLocaleString()}.`)),!r&&!e&&l.push("TodavÃ­a no tengo configurado el mÃ©todo de entrega."),l.push("Si me decÃ­s tu ciudad/zona, te digo lo mejor para vos."),u({action:"asked_location",data:{deliveryEnabled:e,pickupEnabled:r,deliveryFee:h,freeAbove:d,pickupAddress:f}}),{text:l.join(`
`)}}if(O){let e=!!n?.paymentMercadoPago?.enabled,r=!!n?.paymentTransfer?.enabled,h=!!n?.paymentCash&&!!n?.shippingPickup?.enabled,d=r&&o.match(/\b(alias|cbu|transferencia)\b/),f=[];if(e&&f.push("ðŸ’³ Tarjeta (Mercado Pago)"),r&&f.push("ðŸ¦ Transferencia"),h&&f.push("ðŸ’µ Efectivo (solo retiro en local)"),f.length===0)return{text:"TodavÃ­a no tengo mÃ©todos de pago configurados."};if(d){let l=n?.paymentTransfer?.holderName?String(n.paymentTransfer.holderName).trim():"",y=n?.paymentTransfer?.alias?String(n.paymentTransfer.alias).trim():"",s=n?.paymentTransfer?.cbu?String(n.paymentTransfer.cbu).trim():"",p=["Para transferir, usÃ¡ estos datos:"];return l&&p.push(`- Titular: ${l}`),y&&p.push(`- Alias: ${y}`),s&&p.push(`- CBU: ${s}`),!l&&!y&&!s&&p.push("- AÃºn no estÃ¡n cargados los datos."),{text:p.join(`
`)}}return{text:`PodÃ©s pagar con:

${f.map(l=>`- ${l}`).join(`
`)}

Â¿Con cuÃ¡l preferÃ­s?`}}if(fe)return n?.whatsappLink?{text:`Claro. Si necesitas asistencia personalizada ðŸ§‘â€ðŸ’», escribinos por WhatsApp ðŸ“²

[WSP_BUTTON]`}:{text:"Estoy diseÃ±ado para ayudarte las 24hs ðŸ¤–. Â¿BuscÃ¡s algo en especÃ­fico?"};if(pe){let e=A.filter(r=>(Number(r?.discount)||0)>0&&(Number(r?.stock)||0)>0&&r?.isActive!==!1);if(e.length>0){let r=e.sort(()=>.5-Math.random()).slice(0,5);return u({action:"showed_products",shownProducts:r,searchKeywords:[]}),{text:"Las mejores ofertas ahora mismo:",products:r}}return{text:"No tengo productos en oferta por ahora, pero nuestros precios son los mejores ðŸ˜‰ Â¿QuerÃ©s ver alguna categorÃ­a?"}}if(me){let e=Se.filter(r=>{if(!r?.code)return!1;let h=!r.expirationDate||new Date(r.expirationDate)>new Date,d=Array.isArray(r.usedBy)?r.usedBy.length:0,f=!r.usageLimit||d<r.usageLimit;return h&&f});return e.length>0?{text:`Â¡SÃ­! Tenemos estos cupones:

${e.map(h=>`ðŸŽ« **${h.code}** (${h.type==="percentage"?h.value+"%":"$"+h.value} OFF)`).join(`
`)}

Â¡Usalos al finalizar tu compra! ðŸ›’`}:{text:"No hay cupones activos por ahora. Â¿QuerÃ©s ver nuestras ofertas o productos? ðŸ˜Š"}}let Z=o.match(/(?:mas|muy|super)\s*(?:barato|economico|bajo)|mas\s*economico/),ge=o.match(/(?:mas|muy|super)\s*(?:caro|mejor|calidad|top|premium)|costoso|lujo/),ve=o.match(/(?:agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|comprar|quiero|dame|carrito|llevo|lo quiero)/),xe=0,J=1/0,we=o.match(/(?:menos|menor|bajo)\s*(?:de|a|que)?\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(we){let e=X(we[1],o);e!==null&&(J=e)}let R=o.match(/entre\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?\s*y\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(R){let e=X(R[1],o),r=X(R[2],o);e!==null&&(xe=e),r!==null&&(J=r)}let ee=[...new Set(A.flatMap(e=>T(e)))].find(e=>P(e,o)||P(o,e)),I=ee?ee.toLowerCase():null,Ke=new Map([["celu","celular"],["cel","celular"],["tele","televisor"],["tv","televisor"],["compu","computadora"],["notebook","laptop"],["auris","auriculares"],["zapas","zapatillas"],["remera","camiseta"],["remeras","camisetas"],["funda","funda"],["cable","cable"],["cargador","cargador"],["protector","protector"],["vidrio","vidrio templado"]]),E=Pe(o).flatMap(e=>{let r=Ke.get(e);return r?[e,r]:[e]});if(E.length===0&&!I&&!Z&&!ge&&!ve){let e=A.filter(r=>(Number(r.stock)||0)>0&&r.isActive!==!1).find(r=>P(v(r.name),o));return e?(u({action:"showed_products",shownProducts:[e],searchKeywords:[o]}),{text:"Â¿BuscÃ¡s esto?",products:[e]}):{text:"Â¿Me decÃ­s quÃ© producto o categorÃ­a querÃ©s ver? TambiÃ©n podÃ©s preguntar por envÃ­o, pagos o cupones."}}let B=A.filter(e=>(Number(e?.stock)||0)>0&&e?.isActive!==!1);B=B.filter(e=>{let r=$(e);return r>=xe&&r<=J}),I&&(B=B.filter(e=>T(e).some(r=>r.toLowerCase()===I)));let L=B.map(e=>{let r=0,h=v(e.name),d=v(e.description);return E.forEach(f=>{h.includes(f)?r+=10:P(h,f)&&(r+=5),d.includes(f)&&(r+=2)}),I&&!E.length&&(r+=5),e.isFeatured&&(r+=5),e.discount>0&&(r+=3),Z&&(r+=1/($(e)||1)*1e4),ge&&(r+=$(e)/100),{product:e,score:r}}).filter(e=>e.score>0).sort((e,r)=>r.score-e.score).slice(0,5).map(e=>e.product);if(L.length===0){let e=A.filter(r=>(Number(r.discount)||0)>0&&(Number(r.stock)||0)>0).slice(0,3);return e.length>0?(u({action:"showed_products",shownProducts:e,searchKeywords:E}),{text:"No encontrÃ© eso exactamente, pero mirÃ¡ estas opciones con descuento:",products:e}):{text:"No encontrÃ© lo que buscÃ¡s. ProbÃ¡ con otra palabra o preguntame por categorÃ­as ðŸ”Ž"}}if(ve&&L.length>0){let e=L[0];k(e,c);let r=A.filter(h=>h.id!==e.id&&(Number(h.stock)||0)>0&&h.isActive!==!1).sort(()=>.5-Math.random()).slice(0,3);return r.length>0?(u({action:"asked_yes_no",subAction:"cross_sell",data:r,shownProducts:r}),{text:`Â¡Listo! AgreguÃ© **${c}x ${e.name}** al carrito ðŸ›’

Â¿QuerÃ©s ver algo para complementar? ðŸ‘€`,products:[e]}):(b(),{text:`Â¡Listo! AgreguÃ© **${c}x ${e.name}** al carrito ðŸ›’ Â¿Algo mÃ¡s?`,products:[e]})}u({action:"showed_products",shownProducts:L,searchKeywords:E});let U="EncontrÃ© estas opciones. Â¿QuerÃ©s que te muestre mÃ¡s o me decÃ­s un presupuesto?";return I&&(U=`EncontrÃ© esto en **${ee}**:`),Z&&(U="Las opciones mÃ¡s econÃ³micas:"),L.length===1&&(U="EncontrÃ© esto para vos:"),{text:U,products:L}},Ie=async(t,i)=>{let o=null,m=new Promise((c,w)=>{o=setTimeout(()=>w(new Error("timeout")),i)});try{return await Promise.race([t,m])}finally{o&&clearTimeout(o)}},Y=async(t,i={})=>{let o=!!i.alreadyAddedUser,m=String(t||"").trim().slice(0,300);if(!m)return;if(V.current){if(!o){let u={role:"client",text:m};C(b=>[...b,u])}G.current={text:m,alreadyAddedUser:!0};return}V.current=!0,ie("");let c=o?null:{role:"client",text:m},w=[...de.current||[],...c?[c]:[]];c&&C(u=>[...u,c]),ce(!0);try{let u=await Ie(Me(m,w),12e3);if(!K.current)return;let b=u?.text&&typeof u.text=="string"?u.text:"PerdÃ³n, tuve un problema procesando eso. Â¿PodÃ©s reformularlo?",q=Array.isArray(u?.products)?u.products:void 0;C(O=>[...O,{role:"model",text:b,products:q}])}catch{if(!K.current)return;let b=n?.whatsappLink?`Uy, se me trabÃ³ por un momento. Si querÃ©s, hablÃ¡ por WhatsApp:

[WSP_BUTTON]`:"Uy, se me trabÃ³ por un momento. Â¿Probamos de nuevo?";C(q=>[...q,{role:"model",text:b}])}finally{K.current&&ce(!1),V.current=!1;let u=G.current;u&&u.text&&(G.current=null,setTimeout(()=>Y(u.text,{alreadyAddedUser:u.alreadyAddedUser===!0}),0))}},Ee=async()=>Y(H),Be=t=>{let i=String(t||"").trim();i&&Y(i)};return a.default.createElement("div",{"data-testid":"sustia-root",className:"fixed bottom-4 right-4 z-[9999] flex flex-col items-end pointer-events-none"},_&&a.default.createElement("div",{className:"bg-[#0f0f0f]/95 backdrop-blur-2xl border border-white/10 rounded-[2rem] w-[calc(100vw-2rem)] sm:w-80 md:w-96 h-[min(600px,80dvh)] shadow-[0_20px_50px_rgba(0,0,0,0.5)] flex flex-col mb-4 animate-fade-up overflow-hidden font-sans pointer-events-auto ring-1 ring-white/10 relative mr-0 sm:mr-0"},a.default.createElement("div",{className:"bg-gradient-to-r from-yellow-500 to-amber-600 p-5 flex justify-between items-center relative z-10"},a.default.createElement("div",{className:"flex items-center gap-3"},a.default.createElement("div",{className:"p-1 bg-white/20 rounded-full backdrop-blur-md overflow-hidden border border-white/30"},a.default.createElement("img",{src:se,className:"w-9 h-9 object-cover rounded-full",alt:"SustIA"})),a.default.createElement("div",null,a.default.createElement("h3",{className:"font-black text-white text-sm tracking-tight"},"SustIA AI"),a.default.createElement("p",{className:"text-[10px] text-white/90 font-bold flex items-center gap-1.5"},a.default.createElement("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-[0_0_8px_rgba(74,222,128,0.8)]"}),"En lÃ­nea"))),a.default.createElement("div",{className:"flex items-center gap-1"},a.default.createElement("button",{onClick:()=>{try{localStorage.removeItem($e)}catch{}S.current=null,C([ne])},className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Limpiar chat"},a.default.createElement(Ae,{className:"w-5 h-5"})),a.default.createElement("button",{onClick:()=>te(!1),className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Cerrar"},a.default.createElement(oe,{className:"w-5 h-5"})))),a.default.createElement("div",{className:`px-4 py-2 border-b ${Q?"bg-[#111] border-white/5":"bg-slate-50 border-slate-200"}`},a.default.createElement("div",{className:"flex gap-2 overflow-x-auto pb-1 custom-scrollbar"},[{label:"Ofertas",value:"Mostrame ofertas"},{label:"Cupones",value:"TenÃ©s cupones?"},{label:"EnvÃ­o",value:"CÃ³mo es el envÃ­o?"},{label:"Pagos",value:"QuÃ© medios de pago hay?"},{label:"CategorÃ­as",value:"QuÃ© categorÃ­as tenÃ©s?"},{label:"WhatsApp",value:"Necesito hablar con una persona"}].map(t=>a.default.createElement("button",{key:t.label,type:"button","data-testid":`quick-action-${t.label.toLowerCase()}`,onClick:()=>{Be(t.value)},className:Q?"shrink-0 px-3 py-1.5 rounded-full text-[11px] font-bold border border-white/10 bg-[#1a1a1a] text-white hover:bg-[#222] transition":"shrink-0 px-3 py-1.5 rounded-full text-[11px] font-bold border border-slate-200 bg-white text-slate-800 hover:bg-slate-50 transition"},a.default.createElement("span",{className:Q?"text-white":"text-slate-800"},t.label))))),a.default.createElement("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 bg-[#0a0a0a]/50 custom-scrollbar relative"},M.map((t,i)=>a.default.createElement("div",{key:i,className:`flex flex-col ${t.role==="client"?"items-end":"items-start"} animate-fade-in`},a.default.createElement("div",{className:`max-w-[85%] p-4 rounded-2xl text-[13px] leading-relaxed shadow-lg ${t.role==="client"?"bg-gradient-to-br from-yellow-500 to-amber-600 text-white rounded-tr-none border border-white/10":"bg-[#1a1a1a] text-slate-200 rounded-tl-none border border-white/5"}`},t.text&&t.text.includes("[WSP_BUTTON]")?a.default.createElement(a.default.Fragment,null,t.text.split("[WSP_BUTTON]").map((o,m,c)=>a.default.createElement(a.default.Fragment,{key:m},o&&a.default.createElement("p",{className:"whitespace-pre-wrap"},o),m<c.length-1&&n?.whatsappLink&&a.default.createElement("a",{href:n.whatsappLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-2 mb-1 px-4 py-2 bg-green-600 hover:bg-green-500 text-white text-xs font-bold rounded-full transition shadow-lg shadow-green-900/30"},a.default.createElement(Fe,{className:"w-4 h-4"}),"Ir a WhatsApp")))):a.default.createElement("p",{className:"whitespace-pre-wrap"},t.text)),t.products&&t.products.length>0&&a.default.createElement("div",{className:"mt-3 flex gap-3 overflow-x-auto pb-2 w-full custom-scrollbar pl-1 snap-x"},t.products.map(o=>a.default.createElement(Qe,{key:o.id,product:o,onAdd:(m,c)=>{k(m,c),C(w=>[...w,{role:"model",text:`Agregado ${c}x ${m.name} al carrito! ðŸ›’`}])}}))))),le&&a.default.createElement("div",{className:"flex justify-start"},a.default.createElement("div",{className:"bg-[#1a1a1a] p-3 rounded-2xl rounded-bl-none border border-white/5 flex gap-1"},a.default.createElement("span",{className:"w-1.5 h-1.5 bg-slate-500 rounded-full animate-bounce"}),a.default.createElement("span",{className:"w-1.5 h-1.5 bg-slate-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.default.createElement("span",{className:"w-1.5 h-1.5 bg-slate-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}))),a.default.createElement("div",{ref:ue})),a.default.createElement("div",{className:"p-3 bg-[#0a0a0a] border-t border-white/10 relative z-0"},a.default.createElement("form",{onSubmit:t=>{t.preventDefault(),Ee()},className:"flex gap-2 items-center"},a.default.createElement("input",{className:"flex-1 bg-[#1a1a1a] border border-white/10 rounded-full px-4 py-2.5 text-sm text-white focus:border-yellow-500/50 outline-none transition placeholder:text-slate-600",placeholder:"Escribe aquÃ­...",value:H,onChange:t=>ie(t.target.value)}),a.default.createElement("button",{type:"submit",className:"p-2.5 bg-yellow-600 hover:bg-yellow-500 text-white rounded-full transition shadow-lg shadow-yellow-600/20 disabled:opacity-50 disabled:cursor-not-allowed",disabled:le||!H.trim()},a.default.createElement(Ne,{className:"w-4 h-4"}))))),a.default.createElement("button",{onClick:()=>te(!_),"data-testid":"sustia-launcher","aria-label":_?"Cerrar chat de SustIA":"Abrir chat de SustIA",className:"pointer-events-auto w-14 h-14 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(234,179,8,0.4)] hover:scale-110 transition-transform group relative z-50"},_?a.default.createElement(oe,{className:"w-6 h-6 text-white"}):a.default.createElement("div",{className:"w-full h-full p-1"},a.default.createElement("img",{src:se,className:"w-full h-full object-cover rounded-full opacity-95 group-hover:scale-110 transition-transform duration-300",alt:"SustIA"})),!_&&a.default.createElement("span",{className:"absolute -top-1 -right-1 flex h-4 w-4"},a.default.createElement("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"}),a.default.createElement("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-yellow-500 border border-black"}))))},(n,j)=>!(n.settings?.subscriptionPlan!==j.settings?.subscriptionPlan||n.products!==j.products)),oa=We;export{oa as default};
//# sourceMappingURL=SustIABot-HTGSBIDZ.js.map
