import{Ga as Se,b as xt,d as wt,ea as Je,ia as Re,va as et}from"./chunk-HHG3VCLH.js";var s=xt(wt(),1);var $t=({className:u=""})=>s.default.createElement("svg",{viewBox:"0 0 448 512",className:u,fill:"currentColor","aria-hidden":"true",focusable:"false"},s.default.createElement("path",{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-221.7 99.3-221.7 221.7 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 69 27 106.1 27h.1c122.3 0 221.7-99.3 221.7-221.7 0-59.3-23.1-115-64.7-157.3zM223.9 438.7h-.1c-33.1 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3 18.6-68-4.3-7c-18.5-29.4-28.2-63.4-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 54 81.2 54 130.4-.1 101.8-82.9 184.6-184.5 184.6zm101.1-138.2c-5.5-2.8-32.8-16.1-37.9-17.9-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 17.9-17.5 21.6-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.7 35.2 15.2 49 16.5 66.6 14 10.7-1.6 32.8-13.4 37.4-26.3 4.6-12.9 4.6-23.9 3.2-26.3-1.3-2.4-5-3.7-10.5-6.5z"})),tt=u=>{if(!u)return null;let C=[],K=0,B=/(\*\*(.+?)\*\*|~~(.+?)~~|\*(.+?)\*)/g,L=0,M;for(;(M=B.exec(u))!==null;)M.index>L&&C.push(u.slice(L,M.index)),M[2]?C.push(s.default.createElement("strong",{key:K++},M[2])):M[3]?C.push(s.default.createElement("s",{key:K++},M[3])):M[4]&&C.push(s.default.createElement("em",{key:K++},M[4])),L=B.lastIndex;return L<u.length&&C.push(u.slice(L)),C.length>0?C:u},Nt=({product:u,onAdd:C,accentColor:K,idx:B=0})=>{let[L,M]=(0,s.useState)(1),ne=Number(u.basePrice)||0,Ce=ne*(1-(Number(u.discount)||0)/100),G=K||"#f97316";return s.default.createElement("div",{className:"sustia-card-anim min-w-[200px] max-w-[200px] bg-[#1a1a1a] rounded-2xl border border-white/5 overflow-hidden flex flex-col group snap-center hover:border-white/15 transition-all duration-300 hover:-translate-y-1",style:{animationDelay:`${B*80}ms`}},s.default.createElement("div",{className:"relative aspect-square bg-white/95 p-2 overflow-hidden rounded-t-2xl"},s.default.createElement("img",{src:u.image||"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 200 200%27%3E%3Crect fill=%27%23e2e8f0%27 width=%27200%27 height=%27200%27/%3E%3Ctext x=%27100%27 y=%27105%27 text-anchor=%27middle%27 fill=%27%2394a3b8%27 font-size=%2714%27%3ESin imagen%3C/text%3E%3C/svg%3E",className:"w-full h-full object-cover rounded-xl group-hover:scale-110 transition duration-500",alt:u.name||"Producto",loading:"lazy"}),u.discount>0&&s.default.createElement("div",{className:"absolute top-2 left-2 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg",style:{backgroundColor:G}},"-",u.discount,"%")),s.default.createElement("div",{className:"p-3 flex-1 flex flex-col"},s.default.createElement("h4",{className:"text-white font-bold text-xs line-clamp-2 mb-2 leading-tight h-8"},u.name),s.default.createElement("div",{className:"mt-auto"},s.default.createElement("div",{className:"flex items-center gap-2 mb-3"},s.default.createElement("span",{className:"font-black text-sm",style:{color:G}},"$",Math.round(Ce).toLocaleString()),u.discount>0&&s.default.createElement("span",{className:"text-slate-500 text-[10px] line-through"},"$",ne.toLocaleString())),s.default.createElement("div",{className:"flex items-center gap-2"},s.default.createElement("div",{className:"flex bg-black/40 rounded-lg border border-white/5 overflow-hidden"},s.default.createElement("button",{onClick:()=>M(Math.max(1,L-1)),className:"px-2 py-1 text-slate-400 hover:text-white hover:bg-white/5 transition"},"-"),s.default.createElement("span",{className:"px-2 py-1 text-xs text-white font-bold min-w-[24px] text-center"},L),s.default.createElement("button",{onClick:()=>M(Math.min(Number(u.stock)||1,L+1)),className:"px-2 py-1 text-slate-400 hover:text-white hover:bg-white/5 transition"},"+")),s.default.createElement("button",{onClick:()=>C(u,L),className:"flex-1 text-white py-1.5 rounded-lg text-[10px] font-black transition-all flex items-center justify-center gap-1 shadow-lg hover:brightness-110 active:scale-95",style:{backgroundColor:G,boxShadow:`0 4px 12px ${G}33`}},s.default.createElement(Je,{className:"w-3 h-3"})," AGREGAR")))))},kt=s.default.memo(({settings:u,products:C,addToCart:K,controlPanel:B,coupons:L,appId:M,hasFloatingWhatsapp:ne=!1})=>{let G=(()=>{try{return String(window.location.href||"").includes("sustia=1")?!0:new URLSearchParams(window.location.search).get("sustia")==="1"}catch{return!1}})()||u?.subscriptionPlan==="premium",[X,Pe]=(0,s.useState)(!1),[de,qe]=(0,s.useState)(!1),at=u?.primaryColor||"#f97316",z=(()=>{let a=String(at).trim();return/^#[0-9a-fA-F]{6}$/.test(a)?a:/^#[0-9a-fA-F]{3}$/.test(a)?`#${a[1]}${a[1]}${a[2]}${a[2]}${a[3]}${a[3]}`:/^#[0-9a-fA-F]{8}$/.test(a)?a.slice(0,7):"#f97316"})(),je=a=>{let n=a.replace("#","");return[parseInt(n.substring(0,2),16),parseInt(n.substring(2,4),16),parseInt(n.substring(4,6),16)]},me=(()=>{let[a,n,t]=je(z);return`#${Math.max(0,a-30).toString(16).padStart(2,"0")}${Math.max(0,n-30).toString(16).padStart(2,"0")}${Math.max(0,t-30).toString(16).padStart(2,"0")}`})(),O=(a=1)=>{let[n,t,c]=je(z);return`rgba(${n},${t},${c},${a})`};(0,s.useEffect)(()=>{let a="sustia-bot-animations";if(document.getElementById(a))return;let n=document.createElement("style");n.id=a,n.textContent=`
            @keyframes sustia-slide-up { from { opacity:0; transform:translateY(20px) scale(0.95); } to { opacity:1; transform:translateY(0) scale(1); } }
            @keyframes sustia-slide-down { from { opacity:1; transform:translateY(0) scale(1); } to { opacity:0; transform:translateY(20px) scale(0.95); } }
            @keyframes sustia-msg-in-left { from { opacity:0; transform:translateX(-16px); } to { opacity:1; transform:translateX(0); } }
            @keyframes sustia-msg-in-right { from { opacity:0; transform:translateX(16px); } to { opacity:1; transform:translateX(0); } }
            @keyframes sustia-card-in { from { opacity:0; transform:translateY(12px) scale(0.96); } to { opacity:1; transform:translateY(0) scale(1); } }
            @keyframes sustia-pulse-ring { 0% { transform:scale(1); opacity:0.6; } 50% { transform:scale(1.15); opacity:0.3; } 100% { transform:scale(1); opacity:0.6; } }
            @keyframes sustia-bounce-dot { 0%,80%,100% { transform:translateY(0); } 40% { transform:translateY(-6px); } }
            @keyframes sustia-fab-entrance { from { transform:scale(0) rotate(-180deg); opacity:0; } to { transform:scale(1) rotate(0deg); opacity:1; } }
            .sustia-chat-open { animation: sustia-slide-up 0.35s cubic-bezier(0.34,1.56,0.64,1) forwards; }
            .sustia-msg-bot { animation: sustia-msg-in-left 0.3s ease-out forwards; }
            .sustia-msg-user { animation: sustia-msg-in-right 0.3s ease-out forwards; }
            .sustia-card-anim { animation: sustia-card-in 0.35s ease-out both; }
            .sustia-dot { animation: sustia-bounce-dot 1.2s ease-in-out infinite; }
            .sustia-fab { animation: sustia-fab-entrance 0.5s cubic-bezier(0.34,1.56,0.64,1) forwards; }
            .sustia-pulse-ring { animation: sustia-pulse-ring 2s ease-in-out infinite; }
            .sustia-quick-btn { transition: all 0.2s ease; }
            .sustia-quick-btn:hover { transform: translateY(-1px); }
            .sustia-quick-btn:active { transform: translateY(0) scale(0.97); }
        `,document.head.appendChild(n)},[]);let pe=String(u?.botImage||"").trim(),Me=pe&&!/sustia-ai-v2\.jpg$/i.test(pe)?pe:"sustia-ai.jpg",ot=`sustore_sustia_chat_${M}`,_e=u?.storeName||"",Le={role:"model",text:`Â¡Hola! Soy tu asistente virtual${_e?` de **${_e}**`:""} ðŸ¤–. Â¿BuscÃ¡s algo especial hoy? Puedo mostrarte productos, ofertas, cupones, y ayudarte con envÃ­o y pagos.`},[ee,Z]=(0,s.useState)([Le]),[fe,ze]=(0,s.useState)(""),[Te,Ee]=(0,s.useState)(!1),W=(0,s.useRef)(null),De=(0,s.useRef)(null),Ie=(0,s.useRef)(ee),he=(0,s.useRef)(!1),ie=(0,s.useRef)(null),ce=(0,s.useRef)(!0),k=Array.isArray(C)?C:[],Ke=Array.isArray(L)?L:[];(0,s.useEffect)(()=>{let a=()=>{try{qe(document?.documentElement?.classList?.contains("dark-mode")===!0)}catch{qe(!1)}};a();let n;try{n=new MutationObserver(()=>a()),document?.documentElement&&n.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}catch{}return()=>{try{n?.disconnect?.()}catch{}}},[]);let N=a=>a==null?"":String(a).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),ge=a=>{let n=N(a);if(!n)return[];let t=n.split(/[\s,.;:!?/()\\[\]{}"â€œâ€'â€™\-+*_]+/).filter(Boolean),c=new Set(["el","la","los","las","un","una","unos","unas","de","del","en","con","sin","para","por","a","al","que","como","cual","cuales","donde","cuando","quien","quienes","hola","buenas","buenos","dia","dias","tardes","noches","busco","buscar","tenes","tienes","precio","vale","cuesta","quiero","necesito","hay","me","te","mi","mis","tu","tus","agrega","agregar","agregame","agregalo","sumar","sumame","poner","pone","comprar","compralo","llevo","carrito","bolsa","cesta","mas","menos","muy","super","re"]);return t.filter(p=>p.length>1&&!c.has(p)&&!/^\d+$/.test(p))},te=(a,n)=>{if(!a)return null;let t=parseFloat(String(a).replace(",","."));return Number.isFinite(t)?n.includes(`${a}k`)||n.includes(`${a} k`)||n.includes(`${a}mil`)||n.includes(`${a} mil`)?t*1e3:t:null},st=a=>{let n=N(a),t=n.match(/\b(?:x|por)\s*(\d{1,3})\b/);if(t)return Math.max(1,Math.min(99,parseInt(t[1],10)));let c=n.match(/\b(\d{1,3})\s*(?:u|ud|uds|unidad|unidades|pcs|piezas)\b/);if(c)return Math.max(1,Math.min(99,parseInt(c[1],10)));let p=n.match(/\b(?:agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|quiero|llevo|comprar)\s+(\d{1,2})\b/);if(p)return Math.max(1,Math.min(99,parseInt(p[1],10)));let y=n.match(/\b(\d{1,2})\s+(?:agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|quiero|llevo|comprar)\b/);return y?Math.max(1,Math.min(99,parseInt(y[1],10))):1},F=a=>{let n=[];return Array.isArray(a?.categories)&&n.push(...a.categories),typeof a?.category=="string"&&a.category.trim()&&n.push(a.category),n.filter(Boolean).map(t=>String(t).trim()).filter(Boolean)},P=a=>{let n=Number(a?.basePrice)||0,t=Number(a?.discount)||0;return n*(1-t/100)},rt=["buenos aires","caba","capital federal","ciudad autonoma","ciudad de buenos aires","catamarca","chaco","chubut","cordoba","corrientes","entre rios","formosa","jujuy","la pampa","la rioja","mendoza","misiones","neuquen","rio negro","salta","san juan","san luis","santa cruz","santa fe","santiago del estero","tierra del fuego","tucuman"],nt=["adrogue","avellaneda","bahia blanca","banfield","bariloche","bernal","berazategui","burzaco","caleta olivia","campana","caseros","cipolletti","comodoro rivadavia","concordia","devoto","el calafate","el palomar","escobar","ezeiza","florencio varela","general roca","gualeguaychu","hurlingham","iguazu","ituzaingo","jose c paz","junin","la plata","lanus","lomas de zamora","lujan","mar del plata","marcos paz","mercedes","merlo","monte grande","moron","necochea","olavarria","parana","pergamino","pilar","pinamar","posadas","presidencia roque saenz pena","quilmes","rafaela","rawson","reconquista","resistencia","rio cuarto","rio gallegos","rosario","san fernando","san isidro","san justo","san martin","san miguel","san miguel de tucuman","san nicolas","san rafael","san salvador de jujuy","santa rosa","tandil","temperley","tigre","trelew","ushuaia","venado tuerto","villa carlos paz","villa maria","villa mercedes","wilde","zarate","gonzalez catan","virrey del pino","laferrere","rafael castillo","isidro casanova","ciudad evita","aldo bonzi","tapiales","villa luzuriaga","ramos mejia","haedo","castelar","ciudadela","liniers","mataderos","lugano","flores","caballito","almagro","boedo","palermo","belgrano","nunez","recoleta","retiro","microcentro","san telmo","la boca","barracas","constitucion","once","congreso","tribunales","villa crespo","villa urquiza","villa devoto","villa del parque","versalles","monte castro","floresta","velez sarsfield","parque chacabuco","pompeya","soldati","villa lugano","villa riachuelo","parque avellaneda","villa luro","agronomia","chacarita","paternal","villa ortuzar","coghlan","saavedra","villa pueyrredon","parque chas","villa real","puerto madero","san cristobal","balvanera","monserrat","san nicolas barrio","olivos","martinez","acassuso","beccar","boulogne","munro","florida","vicente lopez","don torcuato","el talar","garin","grand bourg","ingeniero maschwitz","los polvorines","pablo nogues","tortuguitas","william morris","general pacheco","benavidez","nordelta","rincon de milberg","dique lujan","general rodriguez","moreno","paso del rey","trujui","francisco alvarez","la reja","guernica","alejandro korn","domselaar","san vicente","canning","esteban echeverria","el jaguel","luis guillon","longchamps","glew","claypole","almirante brown","villa gesell","miramar","tres arroyos","azul","bragado","chivilcoy","chacabuco","pehuajo","trenque lauquen","general villegas","nueve de julio","bolivar","saladillo","lobos","canuelas","san antonio de areco","carmen de areco","capitan sarmiento","san pedro","baradero","ramallo","villa constitucion","san lorenzo","casilda","firmat","chabas","rufino","general pico","rio tercero","villa allende","unquillo","jesus maria","alta gracia","cosquin","la falda","villa giardino","dean funes","cruz del eje","bell ville","marcos juarez","laboulaye","san francisco"],it=[...rt,...nt],ct=new Set(["caca","culo","teta","tetas","pija","pito","mierda","puta","puto","concha","pelotudo","pelotuda","boludo","boluda","forro","forra","verga","poronga","ojete","orto","pete","garcha","cogida","cogido","coger","chupar","chuparla","chupame","chupala","mamada","mogolico","mogolica","tarado","tarada","imbecil","idiota","estupido","estupida","hdp","lcdtm","ctm","ptm","sorete","trola","trolo","gil","gila","pajero","pajera","nabo","naba","salame","bobo","boba","banana","zapallo","pichipe"]),lt=a=>{let c=N(a).split(/\s+/).filter(Boolean).filter(p=>p.length>1);return c.length===0?!0:c.every(p=>ct.has(p))},ut=a=>{let n=N(a);return n.length<2||n.length>60?!1:it.some(t=>t.includes(n)||n.includes(t)?!0:T(t,n)&&n.length>=3)};(0,s.useEffect)(()=>{De.current?.scrollIntoView({behavior:"smooth"})},[ee,X]),(0,s.useEffect)(()=>{Ie.current=ee},[ee]),(0,s.useEffect)(()=>()=>{ce.current=!1},[]);let be=(a,n)=>{if(a===n)return 0;if(!a.length)return n.length;if(!n.length)return a.length;if(Math.abs(a.length-n.length)>3)return Math.abs(a.length-n.length);let t=[];for(let c=0;c<=n.length;c++)t[c]=[c];for(let c=0;c<=a.length;c++)t[0][c]=c;for(let c=1;c<=n.length;c++)for(let p=1;p<=a.length;p++){let y=n[c-1]===a[p-1]?0:1;t[c][p]=Math.min(t[c-1][p]+1,t[c][p-1]+1,t[c-1][p-1]+y)}return t[n.length][a.length]},T=(a,n)=>{if(!n||typeof n!="string"||!a||typeof a!="string")return!1;let t=N(a),c=N(n);if(!t||!c)return!1;if(t.includes(c)||c.includes(t)&&t.length>=3)return!0;let p=t.split(/\s+/),y=c.split(/\s+/);for(let b of y)if(!(b.length<3)){for(let S of p)if(!(S.length<3)&&(S.startsWith(b)||b.startsWith(S)))return!0}for(let b of y){if(b.length<3)continue;let S=b.length<=4?1:b.length<=7?2:3;for(let U of p)if(!(Math.abs(U.length-b.length)>S)&&be(b,U)<=S)return!0}let l=c.replace(/\s+/g,""),A=t.replace(/\s+/g,"");if(l.length>=5&&(A.includes(l)||l.includes(A))||y.length>1&&y.every(b=>b.length<3||t.includes(b)||p.some(S=>be(b,S)<=(b.length<=4?1:2))))return!0;let _=0,v=-1;for(let b of c){let S=t.indexOf(b,v+1);S>-1&&(_++,v=S)}return c.length>=4&&_/c.length>.8},le=(a,n)=>{if(!a||!n)return 0;let t=N(a),c=N(n);if(!t||!c)return 0;if(t===c)return 100;if(t.includes(c))return 90;let p=t.split(/\s+/),y=c.split(/\s+/),l=0,A=0;for(let v of y){if(v.length<2)continue;let b=0;for(let S of p){if(S.length<2)continue;if(S===v){b=Math.max(b,100);continue}if(S.length>=3&&v.length>=3&&(S.startsWith(v)||v.startsWith(S))){b=Math.max(b,80);continue}if(S.length>=3&&v.length>=3&&(S.includes(v)||v.includes(S))){b=Math.max(b,70);continue}let U=v.length<=4?1:v.length<=7?2:3,ae=be(v,S);ae<=U&&(b=Math.max(b,Math.round(70*(1-ae/U))))}b>0&&A++,l+=b}if(y.length===0)return 0;let _=l/y.length;return A===y.length?Math.min(95,_+10):Math.round(_*(A/y.length))},ve=(a,n,t=3)=>{let c=new Set(Array.isArray(n)?n:[]);c.add(a.id);let p=F(a).map(v=>v.toLowerCase()),y=k.filter(v=>!c.has(v.id)&&(Number(v.stock)||0)>0&&v.isActive!==!1),l=y.filter(v=>F(v).some(b=>p.includes(b.toLowerCase())));if(l.length>=t)return l.sort((v,b)=>(b.isFeatured?1:0)-(v.isFeatured?1:0)||(Number(b.discount)||0)-(Number(v.discount)||0)).slice(0,t);let A=P(a),_=y.filter(v=>{let b=P(v);return b>=A*.6&&b<=A*1.4&&!l.includes(v)});return[...l,..._].slice(0,t)},J=a=>{let n=Number(a?.stock)||0;return n<=0?"âŒ Sin stock":n<=3?`ðŸ”¥ Â¡Ãšltimas ${n} unidades!`:n<=10?"âš¡ Quedan pocas unidades":""},Fe=(a,n={})=>{let t=P(a),c=F(a),p=[`ðŸ“¦ **${a.name}**`],y=`ðŸ’° **$${Math.round(t).toLocaleString()}**`;(a.discount||0)>0?p.push(`${y} ~~$${(Number(a.basePrice)||0).toLocaleString()}~~ (${a.discount}% OFF ðŸ”¥)`):p.push(y),a.description&&n.showDesc!==!1&&p.push(`ðŸ“ ${String(a.description).slice(0,200)}`),c.length>0&&p.push(`ðŸ·ï¸ ${c.join(", ")}`);let l=J(a);return l?p.push(l):p.push(`ðŸ“Š Stock: ${a.stock||0} unidades`),p},Q=()=>[...new Set(k.filter(a=>(Number(a.stock)||0)>0&&a.isActive!==!1).flatMap(a=>F(a)))],ye=()=>u?.storeName||"nuestra tienda",dt=async(a,n)=>{await new Promise(e=>setTimeout(e,400+Math.random()*400));let t=N(a),c=String(a||"").trim(),p=st(t),y=W.current;y&&Date.now()-(y.ts||0)>3e5&&(W.current=null);let l=e=>{W.current={...e,ts:Date.now()}},A=()=>{W.current=null};if(t.length<=1){if(W.current)return{text:"No entendÃ­ bien, Â¿podÃ©s escribir un poco mÃ¡s?"};let e=Q().slice(0,2);return{text:`Te leÃ­, pero me falta info ðŸ˜Š. Â¿QuÃ© estÃ¡s buscando? ${e.length>0?`PodÃ©s preguntarme por ${e.map(d=>`*${d}*`).join(", ")}, envÃ­o o pagos.`:"PodÃ©s preguntarme por productos, envÃ­o, pagos o cupones."}`}}if(lt(a))return{text:"No entendÃ­ eso ðŸ˜…. Â¿En quÃ© puedo ayudarte? Preguntame por nuestros productos, envÃ­o, pagos o cupones."};if(t.match(/\b(clima|el tiempo|que tiempo hace|temperatura|futbol|partido|pelicula|receta|cocina|politica|presidente|elecciones|religion|dios|biblia|horoscopo|signo|chiste|chistes|cancion|musica|noticias|dolares?|cotizacion|bitcoin|crypto|programar|codigo|hack|virus|jugar online|descargar gratis|quien gano|como se hace|capital de|cuantos habitantes|que significa|traducir|traduccion)\b/)&&!t.match(/\b(producto|precio|stock|envio|pago|comprar|carrito|oferta|cupon|categoria)\b/))return{text:"Soy el asistente de esta tienda y solo puedo ayudarte con nuestros productos y servicios. Â¿QuerÃ©s que te muestre lo que tenemos?"};if(t.match(/\b(gracias|gracia|muchas gracias|thx|thanks)\b/)&&t.length<40)return A(),k.filter(o=>(Number(o.discount)||0)>0&&(Number(o.stock)||0)>0&&o.isActive!==!1).length>0?{text:"Â¡De nada! ðŸ˜Š Antes de irte, Â¿querÃ©s ver nuestras ofertas del momento?"}:{text:"Â¡De nada! Si necesitÃ¡s algo mÃ¡s, acÃ¡ estoy ðŸ˜Š"};if(t.match(/\b(chau|adios|bye|nos vemos|hasta luego)\b/)&&t.length<30)return A(),{text:`Â¡Gracias por visitar **${ye()}**! ðŸ‘‹ VolvÃ© cuando quieras, estoy acÃ¡ las 24hs.`};if(t.match(/\b(hola|holas|buen dia|buenos dias|buenas tardes|buenas noches|buenas|hello|hi|hey|que tal|como estas|como va|todo bien)\b/)&&t.length<40){A();let e=u?.storeName?` a **${u.storeName}**`:"",o=Q().slice(0,3),d=k.filter(i=>(Number(i.stock)||0)>0&&i.isActive!==!1).length,r=k.filter(i=>(Number(i.discount)||0)>0&&(Number(i.stock)||0)>0&&i.isActive!==!1).length,f=`Â¡Hola! ðŸ‘‹ Bienvenido/a${e}.`;return d>0&&(f+=` Tenemos **${d} productos** disponibles`),o.length>0&&(f+=` en ${o.map(i=>`*${i}*`).join(", ")} y mÃ¡s`),d>0&&(f+="."),r>0&&(f+=` ðŸ”¥ Â¡Hay **${r} productos en oferta**!`),f+=`

Â¿QuÃ© estÃ¡s buscando? Puedo ayudarte con productos, ofertas, cupones, envÃ­o o pagos.`,{text:f}}if(t.match(/\b(quien sos|que sos|que haces|sos real|sos un bot|asistente|como te llamas|tu nombre)\b/)){let e=Q().slice(0,3),o=e.length>0?` Tenemos ${e.join(", ")} y mÃ¡s.`:"";return{text:`Soy el asistente virtual de **${ye()}** ðŸ¤–. Estoy acÃ¡ las 24hs para ayudarte a encontrar lo que necesitÃ¡s, ver ofertas, cupones, consultar envÃ­o y pagos, y armar tu carrito.${o}`}}if(B){if(t.match(/modo\s*(?:oscuro|noche|dark)/))return B.setDarkMode(!0),{text:"Â¡Listo! Modo oscuro activado ðŸŒ™"};if(t.match(/modo\s*(?:claro|dia|light)/))return B.setDarkMode(!1),{text:"Â¡Listo! Modo claro activado â˜€ï¸"};if(t.match(/(?:ver|abrir|ir al|mostrar|mostra)\s*(?:carrito|bolsa|cesta|mi compra)/))return B.openCart(),{text:"Â¡AhÃ­ va! Abriendo tu carrito ðŸ›’"}}let _=!!t.match(/\b(envio|envios|entrega|delivery|domicilio|retiro|retirar|pickup|como llega|cuando llega|hacen envios|mandan|despacho|despachan|llega a|envian)\b/),v=!!t.match(/\b(pago|pagos|tarjeta|mercado\s*pago|transferencia|cbu|alias|efectivo|como pago|formas? de pago|metodos? de pago|cuotas|financiacion)\b/),b=!!t.match(/\b(cupon|cupones|descuento\s*code|code)\b/)||!!(t.match(/\bcodigo\b/)&&t.match(/\b(descuento|promo|cupon|oferta|aplicar|canjear|usar)\b/)),S=!!t.match(/\b(descuento|descuentos|promo|promos|oferta|ofertas|rebaja|rebajas|liquidacion|sale|outlet)\b/),U=!!t.match(/\b(categorias|categoria|rubros|rubro|secciones|que venden|que tienen)\b/),ae=!!t.match(/\b(ayuda|soporte|contacto|human|asesor|whatsapp|humano|hablar con alguien|hablar con una persona|persona real)\b/),Be=!!t.match(/\b(quienes somos|about)\b/)||!!t.match(/\b(sobre|informacion)\b/)&&!t.match(/\bsobre\s+(un|el|la|este|esta|ese|esa|esto)\b/),Oe=!!t.match(/\b(popular|populares|mas vendido|mas vendidos|destacado|destacados|recomendado|recomendados|lo mejor|top ventas|bestseller|tendencia|novedades|nuevo|nuevos|reciente|recientes)\b/),We=!!t.match(/\b(stock|hay stock|disponible|disponibilidad|queda|quedan|tienen|tenes)\b/)&&!!t.match(/\b(stock|disponib)/),Qe=!!t.match(/\b(precio|cuanto\s*(?:sale|cuesta|vale|es)|cuanto\s*esta|a cuanto)\b/),Ue=!!t.match(/\b(garantia|devolucion|devoluciones|cambio|cambios|reclamo|defecto|roto|falla)\b/),He=!!t.match(/\b(tengo|presupuesto|dispongo|gasto|gastar)\s*\$?\s*\d/),Ye=!!t.match(/\b(no me gusta|no me gusto|feo|feos|fea|feas|no me convence|no me sirve|malo|mala|malos|malas|horrible|espantoso|no me copa|no va|ninguno|ninguna|no quiero nada de eso|nada de eso)\b/),bt=_||v||b||S||U||ae||Be||Oe||We||Qe||Ue||He;if(W.current&&!bt){let e=W.current,o=!!t.match(/\b(si|sip|sep|claro|dale|bueno|yes|por favor|obvio|ok|sale|va|vamos|manda|mostrame|show|demas|genial|perfecto)\b/),d=!!t.match(/\b(no|nah|paso|cancelar|nada|asi esta bien|despues|luego|no gracias|esta bien asi|listo|ya esta|basta)\b/),r=o&&!(d&&t.match(/^no\b/)),f=d&&!r;if(e.action==="asked_location"){let i=c;if(!ut(i))return{text:"No reconozco esa ubicaciÃ³n ðŸ¤”. Decime tu ciudad o provincia de Argentina (ej: *CÃ³rdoba*, *Rosario*, *CABA*, *Mar del Plata*)."};A();let{deliveryEnabled:j,pickupEnabled:x,deliveryFee:q,freeAbove:m,pickupAddress:g}=e.data||{},h=N(g),w=N(i),$=h&&(h.includes(w)||w.includes((h.split(",")[0]||"").trim())),D=[`ðŸ“ Para **${i}**:`];if(x&&$?D.push(`âœ… PodÃ©s retirar en nuestro local: **${g}** â€” Â¡sin costo de envÃ­o!`):x&&D.push(`ðŸª Tenemos retiro en local en **${g||"direcciÃ³n a coordinar"}**, pero queda en otra zona.`),j){let V=q>0?`$${q.toLocaleString()}`:"**sin costo**";D.push(`ðŸšš Hacemos envÃ­os a domicilio (${V}${m>0?`, gratis superando $${m.toLocaleString()}`:""}).`),D.push(`Para confirmar costo exacto a ${i}, avanzÃ¡ al checkout o consultanos.`)}return!x&&!j&&D.push("TodavÃ­a no tenemos envÃ­o configurado. Consultanos para coordinar."),u?.whatsappLink&&D.push(`
[WSP_BUTTON]`),D.push(`
Â¿QuerÃ©s que te muestre productos o necesitÃ¡s algo mÃ¡s?`),{text:D.join(`
`)}}if(e.action==="showed_products"&&Array.isArray(e.shownProducts)&&e.shownProducts.length>0){let i=e.shownProducts;if(Ye){let m=new Set(i.map($=>$.id)),g=k.filter($=>!m.has($.id)&&(Number($.stock)||0)>0&&$.isActive!==!1);if(Array.isArray(e.searchKeywords)&&e.searchKeywords.length>0){let $=g.filter(D=>{let V=N(D.name);return e.searchKeywords.some(re=>V.includes(re)||T(V,re))});$.length>0&&(g=$)}let h=g.slice(0,5);if(h.length>0)return l({action:"showed_products",shownProducts:h,searchKeywords:e.searchKeywords}),{text:"Â¡Sin problema! Te muestro otras opciones:",products:h};let w=Q().slice(0,4);return w.length>0?(l({action:"asked_category"}),{text:`Entiendo. No tengo mÃ¡s opciones con ese criterio, pero podÃ©s buscar en otra categorÃ­a:

${w.map($=>`- ${$}`).join(`
`)}

Â¿CuÃ¡l te interesa?`}):{text:"Entiendo. Decime quÃ© tipo de producto buscÃ¡s y te ayudo a encontrarlo."}}if(t.match(/\b(caro|carisimo|carisima|costoso|mucha plata|sale mucho|no me alcanza|no llego|fuera de presupuesto|excede)\b/)&&!t.match(/\b(mas caro|el mas caro|lo mas caro)\b/)){let m=k.filter(h=>(Number(h.stock)||0)>0&&h.isActive!==!1&&!i.some(w=>w.id===h.id)).filter(h=>{if(!Array.isArray(e.searchKeywords)||e.searchKeywords.length===0)return!0;let w=N(h.name);return e.searchKeywords.some($=>w.includes($)||T(w,$))}).sort((h,w)=>P(h)-P(w)).slice(0,5);if(m.length>0)return l({action:"showed_products",shownProducts:m,searchKeywords:e.searchKeywords}),{text:"Â¡Entendido! Te muestro opciones mÃ¡s accesibles ðŸ’ª:",products:m};let g=Ke.filter(h=>h?.code&&(!h.expirationDate||new Date(h.expirationDate)>new Date));if(g.length>0){let h=g[0];return{text:`Entiendo que el precio es alto. Â¡Pero tenemos un cupÃ³n que te puede ayudar! ðŸŽ« UsÃ¡ **${h.code}** (${h.type==="percentage"?h.value+"%":"$"+h.value} OFF) al finalizar tu compra.`}}return{text:"No tengo opciones mÃ¡s econÃ³micas en ese rubro, pero nuestros precios son competitivos. Â¿QuerÃ©s buscar en otra categorÃ­a?"}}let j=[{p:/\b(primero|primer|1ro|1ero|1Â°)\b/,i:0},{p:/\b(segundo|2do|2Â°)\b/,i:1},{p:/\b(tercero|tercer|3ro|3ero|3Â°)\b/,i:2},{p:/\b(cuarto|4to|4Â°)\b/,i:3},{p:/\b(ultimo|quinto|5to|5Â°)\b/,i:i.length-1}],x=null;for(let m of j)if(t.match(m.p)&&i[m.i]){x=i[m.i];break}if(!x&&t.match(/\b(ese|este|eso|esto|el de arriba)\b/)&&(x=i[0]),!x){let m=t.match(/\b(?:el|la|n[uÃº]mero)\s*(\d)\b/);m&&i[parseInt(m[1],10)-1]&&(x=i[parseInt(m[1],10)-1])}if(!x&&t.length>3&&(x=i.find(m=>{let g=N(m.name);if(!g)return!1;let h=g.split(" ")[0]||"";return g.includes(t)||h.length>=3&&t.includes(h)})),!!t.match(/\b(agrega|agregar|agregame|agregalo|sum[aÃ¡]|sumale|pone|poner|met[eÃ©]|comprar|compralo|quiero|dame|llevo|lo quiero|al carrito|sumalo|mandalo|mandame|lo llevo|me lo llevo)\b/)){let m=x||i[0];K(m,p);let g=ve(m,i.map($=>$.id)),h=J(m),w=`âœ… Â¡AgreguÃ© **${p}x ${m.name}** al carrito!`;return h&&(Number(m.stock)||0)<=3&&(w+=` ${h}`),g.length>0?(l({action:"asked_yes_no",subAction:"cross_sell",data:g,shownProducts:g}),w+=`

ðŸ›ï¸ Clientes que compraron esto tambiÃ©n vieron:`,{text:w,products:[m,...g]}):(A(),w+=" ðŸ›’ Â¿NecesitÃ¡s algo mÃ¡s?",{text:w,products:[m]})}if(x&&t.match(/\b(info|detalle|detalles|especif|descrip|cuenta|contame|mas sobre|que es|que tiene|caracteristicas|features)\b/)){let m=x,g=Fe(m);return g.push(`
Â¿Lo agregamos al carrito? ðŸ›’`),l({action:"asked_yes_no",subAction:"add_product",data:m,shownProducts:i}),{text:g.join(`
`),products:[m]}}if(x){let m=x,g=P(m),h=J(m),w=`**${m.name}** â€” **$${Math.round(g).toLocaleString()}**`;return(m.discount||0)>0&&(w+=` (Â¡${m.discount}% OFF! ðŸ”¥)`),h&&(w+=`
${h}`),w+=`

Â¿Lo agrego al carrito? ðŸ›’`,l({action:"asked_yes_no",subAction:"add_product",data:m,shownProducts:i}),{text:w,products:[m]}}if(t.match(/\b(barato|economico|baratos|economicos|menor precio|accesible)\b/)){let m=[...i].sort((g,h)=>P(g)-P(h));return l({action:"showed_products",shownProducts:m,searchKeywords:e.searchKeywords}),{text:"ðŸ’° De mÃ¡s accesible a mayor precio:",products:m}}if(t.match(/\b(caro|caros|premium|mejor calidad|top|mejor|gama alta)\b/)){let m=[...i].sort((g,h)=>P(h)-P(g));return l({action:"showed_products",shownProducts:m,searchKeywords:e.searchKeywords}),{text:"â­ Las opciones premium:",products:m}}if(t.match(/\b(otro|otros|otras|mas opciones|ver mas|siguiente|siguientes|que mas hay|hay mas|mostrame mas|tenes mas)\b/)){let m=new Set(i.map($=>$.id)),g=k.filter($=>!m.has($.id)&&(Number($.stock)||0)>0&&$.isActive!==!1);if(Array.isArray(e.searchKeywords)&&e.searchKeywords.length>0){let $=g.filter(D=>{let V=N(D.name);return e.searchKeywords.some(re=>V.includes(re)||T(V,re))});$.length>0&&(g=$)}let h=g.slice(0,5);if(h.length>0)return l({action:"showed_products",shownProducts:h,searchKeywords:e.searchKeywords}),{text:"Â¡AcÃ¡ van mÃ¡s opciones! ðŸ‘‡",products:h};let w=Q().slice(0,4);return w.length>0?(l({action:"asked_category"}),{text:`No tengo mÃ¡s opciones con ese criterio. Â¿QuerÃ©s explorar otra categorÃ­a?

${w.map($=>`- ${$}`).join(`
`)}`}):{text:"No tengo mÃ¡s opciones con ese criterio. Â¿QuerÃ©s buscar algo diferente?"}}if(t.match(/\b(compar[aÃ¡e]|diferencia|cual es mejor|cual conviene|vs|versus)\b/)&&i.length>=2){let[m,g]=i.slice(0,2),h=P(m),w=P(g);return{text:["ðŸ“Š **ComparaciÃ³n rÃ¡pida:**","",`**${m.name}** â†’ $${Math.round(h).toLocaleString()}${(m.discount||0)>0?` (${m.discount}% OFF)`:""}`,`**${g.name}** â†’ $${Math.round(w).toLocaleString()}${(g.discount||0)>0?` (${g.discount}% OFF)`:""}`,"",h<w?`ðŸ’¡ **${m.name}** es mÃ¡s econÃ³mico.`:h>w?`ðŸ’¡ **${g.name}** es mÃ¡s econÃ³mico.`:"ðŸ’¡ Tienen el mismo precio.","","Â¿CuÃ¡l te interesa? Decime y lo agrego al carrito."].join(`
`)}}}if(e.action==="asked_yes_no"){if(r){if(e.subAction==="cross_sell"&&Array.isArray(e.data))return l({action:"showed_products",shownProducts:e.data,searchKeywords:[]}),{text:"Â¡MirÃ¡ estas opciones! ðŸ”¥ Â¿Alguna te interesa?",products:e.data};if(e.subAction==="show_deals"&&Array.isArray(e.data))return l({action:"showed_products",shownProducts:e.data,searchKeywords:[]}),{text:"Las mejores ofertas ahora mismo ðŸ”¥:",products:e.data};if(e.subAction==="show_popular"&&Array.isArray(e.data))return l({action:"showed_products",shownProducts:e.data,searchKeywords:[]}),{text:"Lo mÃ¡s destacado de la tienda â­:",products:e.data};if(e.subAction==="add_product"&&e.data){K(e.data,p),A();let i=ve(e.data,[e.data.id]);return i.length>0?(l({action:"asked_yes_no",subAction:"cross_sell",data:i,shownProducts:i}),{text:`âœ… Â¡AgreguÃ© **${p}x ${e.data.name}** al carrito! ðŸ›’

Â¿QuerÃ©s ver productos relacionados?`,products:[e.data]}):{text:`âœ… Â¡AgreguÃ© **${p}x ${e.data.name}** al carrito! ðŸ›’ Â¿NecesitÃ¡s algo mÃ¡s?`,products:[e.data]}}}if(f)return A(),{text:"Â¡Perfecto! Â¿NecesitÃ¡s algo mÃ¡s? Puedo ayudarte con otros productos, envÃ­o o pagos ðŸ˜Š"}}if(e.action==="asked_category"){let j=[...new Set([...Array.isArray(u?.categories)?u.categories:[],...k.flatMap(x=>F(x))])].find(x=>T(N(x),t)||T(t,N(x)));if(j){let x=k.filter(q=>(Number(q.stock)||0)>0&&q.isActive!==!1&&F(q).some(m=>m.toLowerCase()===j.toLowerCase())).sort((q,m)=>(m.isFeatured?1:0)-(q.isFeatured?1:0)||(Number(m.discount)||0)-(Number(q.discount)||0)).slice(0,5);if(x.length>0){l({action:"showed_products",shownProducts:x,searchKeywords:[]});let q=x.filter(g=>(Number(g.discount)||0)>0).length,m=`Lo mejor de **${j}**:`;return q>0&&(m+=` (${q} en oferta ðŸ”¥)`),{text:m,products:x}}return{text:`No hay productos disponibles en "${j}" ahora. Â¿Buscamos en otra categorÃ­a?`}}}}if(Oe){let e=!!t.match(/\b(nuevo|nuevos|reciente|recientes|novedades)\b/),o;return e?o=k.filter(d=>(Number(d.stock)||0)>0&&d.isActive!==!1).sort((d,r)=>{let f=d.createdAt?new Date(d.createdAt).getTime():0;return(r.createdAt?new Date(r.createdAt).getTime():0)-f}).slice(0,5):o=k.filter(d=>(Number(d.stock)||0)>0&&d.isActive!==!1).sort((d,r)=>(r.isFeatured?10:0)+(Number(r.discount)||0)-((d.isFeatured?10:0)+(Number(d.discount)||0))).slice(0,5),o.length>0?(l({action:"showed_products",shownProducts:o,searchKeywords:[]}),{text:`${e?"Lo mÃ¡s nuevo":"Lo mÃ¡s destacado"} de **${ye()}** â­:`,products:o}):{text:"TodavÃ­a no tenemos productos destacados. Â¿QuerÃ©s ver nuestras categorÃ­as?"}}if(We&&t.length>15){let e=ge(t).filter(o=>!["stock","disponible","disponibilidad","queda","quedan","tienen","tenes","hay"].includes(o));if(e.length>0){let o=k.find(d=>{let r=N(d.name);return e.some(f=>r.includes(f)||T(r,f))});if(o){let d=Number(o.stock)||0,r=J(o),f=P(o);return d>0?(l({action:"asked_yes_no",subAction:"add_product",data:o,shownProducts:[o]}),{text:`âœ… **${o.name}** estÃ¡ disponible.
${r||`ðŸ“Š Stock: ${d} unidades`}
ðŸ’° $${Math.round(f).toLocaleString()}${(o.discount||0)>0?` (${o.discount}% OFF ðŸ”¥)`:""}

Â¿Lo agrego al carrito?`,products:[o]}):{text:`ðŸ˜• **${o.name}** no tiene stock en este momento. Â¿QuerÃ©s que te muestre alternativas?`}}}}if(Qe){let e=ge(t).filter(o=>!["precio","cuanto","sale","cuesta","vale","esta"].includes(o));if(e.length>0){let o=k.find(d=>{let r=N(d.name);return e.some(f=>r.includes(f)||T(r,f))});if(o){let d=P(o),r=Fe(o,{showDesc:!1});return r.push(`
Â¿Lo agrego al carrito? ðŸ›’`),l({action:"asked_yes_no",subAction:"add_product",data:o,shownProducts:[o]}),{text:r.join(`
`),products:[o]}}}}if(Ue)return u?.whatsappLink?{text:`Para consultas sobre garantÃ­a, devoluciones o cambios, lo mejor es que nos escribas directamente ðŸ“²

[WSP_BUTTON]`}:{text:"Las consultas de garantÃ­a, devoluciones y cambios se manejan caso por caso. Contactanos para resolverlo rÃ¡pido."};if(He){let e=t.match(/\b(?:tengo|presupuesto|dispongo|gasto|gastar)\s*(?:de)?\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?\b/);if(e){let o=te(e[1],t);if(o&&o>0){let d=k.filter(r=>(Number(r.stock)||0)>0&&r.isActive!==!1&&P(r)<=o).sort((r,f)=>{let i=(f.isFeatured?10:0)+(Number(f.discount)||0),j=(r.isFeatured?10:0)+(Number(r.discount)||0);return i-j||P(f)-P(r)}).slice(0,5);return d.length>0?(l({action:"showed_products",shownProducts:d,searchKeywords:[]}),{text:`ðŸ’° Con un presupuesto de **$${o.toLocaleString()}** te recomiendo:`,products:d}):{text:`No encontrÃ© productos dentro de $${o.toLocaleString()} ðŸ˜•. Â¿QuerÃ©s que te muestre las opciones mÃ¡s econÃ³micas?`}}}}if(U){let e=[...new Set(k.flatMap(r=>F(r)))],o=[...new Set([...Array.isArray(u?.categories)?u.categories:[],...e])].map(r=>String(r).trim()).filter(Boolean);return o.length===0?{text:"TodavÃ­a no tengo categorÃ­as configuradas. Decime quÃ© estÃ¡s buscando y lo resuelvo igual."}:(l({action:"asked_category"}),{text:`Tenemos **${k.filter(r=>(Number(r.stock)||0)>0&&r.isActive!==!1).length} productos** en estas categorÃ­as:

${o.slice(0,10).map(r=>`- ${r}`).join(`
`)}

Decime cuÃ¡l te interesa y te muestro las mejores opciones ðŸ‘‡`})}if(Be){let e=u?.aboutUsText||"";return e.trim()?{text:e.trim()}:{text:"Esta tienda todavÃ­a no cargÃ³ su secciÃ³n â€œSobre nosotrosâ€. Â¿QuerÃ©s que te ayude a encontrar un producto?"}}if(_){let e=!!u?.shippingDelivery?.enabled,o=!!u?.shippingPickup?.enabled,d=Number(u?.shippingDelivery?.fee)||0,r=Number(u?.shippingDelivery?.freeAbove)||0,f=u?.shippingPickup?.address||"",i=[];return o&&i.push(`ðŸ“ Retiro en local: ${f?`**${f}**`:"a coordinar"} â€” Â¡sin costo!`),e&&(r>0?i.push(`ðŸšš EnvÃ­o a domicilio: $${d.toLocaleString()} (gratis desde $${r.toLocaleString()}).`):d>0?i.push(`ðŸšš EnvÃ­o a domicilio: $${d.toLocaleString()}.`):i.push("ðŸšš EnvÃ­o a domicilio: **Â¡GRATIS!** ðŸŽ‰")),!o&&!e&&i.push("TodavÃ­a no tenemos configurado el mÃ©todo de entrega."),i.push(`
Decime tu ciudad/zona y te digo la mejor opciÃ³n para vos.`),l({action:"asked_location",data:{deliveryEnabled:e,pickupEnabled:o,deliveryFee:d,freeAbove:r,pickupAddress:f}}),{text:i.join(`
`)}}if(v){let e=!!u?.paymentMercadoPago?.enabled,o=!!u?.paymentTransfer?.enabled,d=!!u?.paymentCash&&!!u?.shippingPickup?.enabled,r=o&&t.match(/\b(alias|cbu|transferencia)\b/),f=[];if(e&&f.push("ðŸ’³ Tarjeta / Mercado Pago (podÃ©s pagar en cuotas)"),o&&f.push("ðŸ¦ Transferencia bancaria"),d&&f.push("ðŸ’µ Efectivo (solo retiro en local)"),f.length===0)return{text:"TodavÃ­a no tenemos mÃ©todos de pago configurados."};if(r){let i=u?.paymentTransfer?.holderName?String(u.paymentTransfer.holderName).trim():"",j=u?.paymentTransfer?.alias?String(u.paymentTransfer.alias).trim():"",x=u?.paymentTransfer?.cbu?String(u.paymentTransfer.cbu).trim():"",q=["ðŸ¦ **Datos para transferencia:**"];return i&&q.push(`- Titular: **${i}**`),j&&q.push(`- Alias: **${j}**`),x&&q.push(`- CBU: **${x}**`),!i&&!j&&!x&&q.push("- AÃºn no estÃ¡n cargados los datos."),q.push(`
Una vez transferido, enviÃ¡ el comprobante para confirmar tu pedido.`),{text:q.join(`
`)}}return{text:`Aceptamos estos medios de pago:

${f.map(i=>`- ${i}`).join(`
`)}

Â¿NecesitÃ¡s los datos de transferencia o querÃ©s pagar con tarjeta?`}}if(ae)return u?.whatsappLink?{text:`Â¡Por supuesto! Si necesitÃ¡s atenciÃ³n personalizada ðŸ§‘â€ðŸ’», escribinos por WhatsApp y te respondemos al toque ðŸ“²

[WSP_BUTTON]`}:{text:"Estoy acÃ¡ las 24hs para ayudarte ðŸ¤–. Preguntame lo que necesites sobre productos, precios, envÃ­o o pagos."};if(S){let e=k.filter(o=>(Number(o?.discount)||0)>0&&(Number(o?.stock)||0)>0&&o?.isActive!==!1);if(e.length>0){let o=e.sort((r,f)=>(Number(f.discount)||0)-(Number(r.discount)||0)).slice(0,5);l({action:"showed_products",shownProducts:o,searchKeywords:[]});let d=Math.max(...o.map(r=>Number(r.discount)||0));return{text:`ðŸ”¥ **${e.length} productos en oferta** (hasta ${d}% OFF):`,products:o}}return{text:"No tenemos ofertas activas en este momento, pero nuestros precios son muy competitivos ðŸ˜‰. Â¿QuerÃ©s ver alguna categorÃ­a?"}}if(b){let e=Ke.filter(o=>{if(!o?.code)return!1;let d=!o.expirationDate||new Date(o.expirationDate)>new Date,r=Array.isArray(o.usedBy)?o.usedBy.length:0,f=!o.usageLimit||r<o.usageLimit;return d&&f});return e.length>0?{text:`Â¡SÃ­! Tenemos cupones activos ðŸŽ‰:

${e.map(d=>`ðŸŽ« **${d.code}** â€” ${d.type==="percentage"?d.value+"% OFF":"$"+d.value+" de descuento"}`).join(`
`)}

ðŸ’¡ Aplicalos en el checkout para obtener tu descuento.`}:{text:"No hay cupones activos por ahora. Pero te recomiendo ver nuestras ofertas, Â¡hay buenos descuentos! ðŸ˜Š Â¿QuerÃ©s que te las muestre?"}}let we=t.match(/\b(?:mas|muy|super)\s*(?:barato|economico|bajo|accesible)\b|\bmas\s*economico\b|\bmas\s*accesible\b/),$e=t.match(/\b(?:mas|muy|super)\s*(?:caro|mejor|calidad|top|premium|gama alta)\b|\bcostoso\b|\blujo\b/),Ve=t.match(/\b(?:agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|comprar|quiero|dame|carrito|llevo|lo quiero|mandame|me lo llevo)\b/),Y=0,H=1/0,Ne=t.match(/\b(?:menos|menor|bajo|hasta|maximo)\s*(?:de|a|que)?\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(Ne){let e=te(Ne[1],t);e!==null&&(H=e)}let Ge=t.match(/\b(?:mas|mayor|desde|minimo|arriba)\s*(?:de|a|que)?\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(Ge&&!Ne){let e=te(Ge[1],t);e!==null&&(Y=e)}let ke=t.match(/entre\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?\s*y\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(ke){let e=te(ke[1],t),o=te(ke[2],t);e!==null&&(Y=e),o!==null&&(H=o)}let Ae=[...new Set(k.flatMap(e=>F(e)))].find(e=>T(e,t)||T(t,e)),oe=Ae?Ae.toLowerCase():null,Xe=new Map,vt=[["celu","celular"],["cel","celular"],["tele","televisor"],["tv","televisor"],["compu","computadora"],["notebook","laptop"],["auris","auriculares"],["zapas","zapatillas"],["remera","camiseta"],["remeras","camisetas"],["joystick","control"],["mando","control"],["play","playstation"],["ps5","playstation 5"],["ps4","playstation 4"],["xbox","xbox"],["switch","nintendo switch"],["micro","microfono"],["parlante","speaker"],["cam","camara"],["bici","bicicleta"],["moto","motocicleta"],["pc","computadora"],["tablet","tableta"]],Ze=k.map(e=>N(e.name)).join(" ");for(let[e,o]of vt)(Ze.includes(N(o))||Ze.includes(N(e)))&&Xe.set(e,o);let R=ge(t).flatMap(e=>{let o=Xe.get(e);return o?[e,o]:[e]});if(Ye&&R.length===0){let e=Q().slice(0,4);return e.length>0?(l({action:"asked_category"}),{text:`Entendido. Â¿QuÃ© te gustarÃ­a ver? Tenemos:

${e.map(o=>`- ${o}`).join(`
`)}

Decime cuÃ¡l te interesa ðŸ‘‡`}):{text:"Entendido. Â¿PodÃ©s decirme quÃ© tipo de producto estÃ¡s buscando?"}}if(R.length===0&&!oe&&!we&&!$e&&!Ve){let e=k.filter(r=>(Number(r.stock)||0)>0&&r.isActive!==!1).map(r=>({product:r,sim:le(r.name,t)})).filter(r=>r.sim>=40).sort((r,f)=>f.sim-r.sim);if(e.length>0){let r=e.slice(0,5).map(f=>f.product);return l({action:"showed_products",shownProducts:r,searchKeywords:[t]}),{text:r.length===1?"Â¿BuscÃ¡s esto?":"Creo que buscÃ¡s algo de esto:",products:r}}let o=k.filter(r=>(Number(r.stock)||0)>0&&r.isActive!==!1).find(r=>T(N(r.name),t));if(o)return l({action:"showed_products",shownProducts:[o],searchKeywords:[t]}),{text:"Â¿BuscÃ¡s esto?",products:[o]};let d=Q().slice(0,5);return d.length>0?(l({action:"asked_category"}),{text:`No estoy seguro de quÃ© necesitÃ¡s. Estas son nuestras categorÃ­as:

${d.map(r=>`- ${r}`).join(`
`)}

Â¿CuÃ¡l te interesa?`}):{text:"No estoy seguro de quÃ© necesitÃ¡s. Â¿PodÃ©s decirme el nombre del producto o quÃ© tipo de producto buscÃ¡s?"}}let se=k.filter(e=>(Number(e?.stock)||0)>0&&e?.isActive!==!1);se=se.filter(e=>{let o=P(e);return o>=Y&&o<=H}),oe&&(se=se.filter(e=>F(e).some(o=>o.toLowerCase()===oe)));let I=se.map(e=>{let o=0,d=N(e.name),r=N(e.description),f=F(e).map(i=>N(i)).join(" ");if(R.forEach(i=>{if(d.includes(i))o+=15;else{let j=le(d,i);j>=60&&(o+=Math.round(j/10))}r.includes(i)?o+=4:T(r,i)&&(o+=2),f.includes(i)?o+=5:T(f,i)&&(o+=3)}),t.length>=4){let i=le(d,t);i>=50&&(o+=Math.round(i/10))}return oe&&!R.length&&(o+=5),e.isFeatured&&(o+=5),e.discount>0&&(o+=3),we&&(o+=1/(P(e)||1)*1e4),$e&&(o+=P(e)/100),{product:e,score:o}}).filter(e=>e.score>0).sort((e,o)=>o.score-e.score).slice(0,5).map(e=>e.product);if(I.length===0){let e=k.filter(r=>(Number(r.stock)||0)>0&&r.isActive!==!1).map(r=>({product:r,sim:le(r.name,t)})).filter(r=>r.sim>=35).sort((r,f)=>f.sim-r.sim).slice(0,5).map(r=>r.product);if(e.length>0)return l({action:"showed_products",shownProducts:e,searchKeywords:R}),{text:e.length===1?"Â¿SerÃ¡ esto lo que buscÃ¡s?":"Â¿BuscÃ¡s alguno de estos?",products:e};if(H<1/0||Y>0)return{text:`No encontrÃ© productos ${Y>0&&H<1/0?`entre $${Y.toLocaleString()} y $${H.toLocaleString()}`:H<1/0?`hasta $${H.toLocaleString()}`:`desde $${Y.toLocaleString()}`} con ese criterio. Â¿QuerÃ©s que amplÃ­e el rango de precio o busque en otra categorÃ­a?`};let o=Q().slice(0,5);return{text:`No encontrÃ© lo que buscÃ¡s en nuestra tienda ðŸ”Ž. ProbÃ¡ con otra palabra o preguntame por categorÃ­as.${o.length>0?`

Nuestras categorÃ­as: ${o.map(r=>`**${r}**`).join(", ")}. Â¿QuerÃ©s ver alguna?`:""}`}}if(Ve&&I.length>0){let e=I[0];K(e,p);let o=ve(e,I.map(f=>f.id)),d=J(e),r=`âœ… Â¡AgreguÃ© **${p}x ${e.name}** al carrito!`;return d&&(Number(e.stock)||0)<=3&&(r+=` ${d}`),o.length>0?(l({action:"asked_yes_no",subAction:"cross_sell",data:o,shownProducts:o}),r+=`

ðŸ›ï¸ Te pueden interesar tambiÃ©n:`,{text:r,products:[e,...o]}):(A(),r+=" ðŸ›’ Â¿NecesitÃ¡s algo mÃ¡s?",{text:r,products:[e]})}l({action:"showed_products",shownProducts:I,searchKeywords:R});let E,ue=I.filter(e=>(Number(e.discount)||0)>0).length,yt=I.filter(e=>(Number(e.stock)||0)<=3).length;if(I.length===1){let e=I[0],o=J(e);E="EncontrÃ© esto para vos:",o&&(E+=` ${o}`)}else oe?(E=`Lo mejor de **${Ae}**`,ue>0&&(E+=` (${ue} en oferta ðŸ”¥)`),E+=":"):we?E="ðŸ’° Las opciones mÃ¡s accesibles:":$e?E="â­ Las opciones premium:":(E=`EncontrÃ© **${I.length} opciones** para vos`,ue>0&&(E+=` (${ue} en oferta ðŸ”¥)`),yt>0&&(E+=" â€” Â¡apurate, hay pocas unidades!"),E+=":");return{text:E,products:I}},mt=async(a,n)=>{let t=null,c=new Promise((p,y)=>{t=setTimeout(()=>y(new Error("timeout")),n)});try{return await Promise.race([a,c])}finally{t&&clearTimeout(t)}},xe=async(a,n={})=>{let t=!!n.alreadyAddedUser,c=String(a||"").trim().slice(0,300);if(!c)return;if(he.current){if(!t){let l={role:"client",text:c};Z(A=>[...A,l])}ie.current={text:c,alreadyAddedUser:!0};return}he.current=!0,ze("");let p=t?null:{role:"client",text:c},y=[...Ie.current||[],...p?[p]:[]];p&&Z(l=>[...l,p]),Ee(!0);try{let l=await mt(dt(c,y),12e3);if(!ce.current)return;let A=l?.text&&typeof l.text=="string"?l.text:"PerdÃ³n, tuve un problema procesando eso. Â¿PodÃ©s reformularlo?",_=Array.isArray(l?.products)?l.products:void 0;Z(v=>[...v,{role:"model",text:A,products:_}])}catch{if(!ce.current)return;let A=u?.whatsappLink?`Uy, se me trabÃ³ por un momento. Si querÃ©s, hablÃ¡ por WhatsApp:

[WSP_BUTTON]`:"Uy, se me trabÃ³ por un momento. Â¿Probamos de nuevo?";Z(_=>[..._,{role:"model",text:A}])}finally{if(he.current=!1,ce.current){Ee(!1);let l=ie.current;l&&l.text&&(ie.current=null,setTimeout(()=>xe(l.text,{alreadyAddedUser:l.alreadyAddedUser===!0}),0))}else ie.current=null}},pt=async()=>xe(fe),ft=a=>{let n=String(a||"").trim();n&&xe(n)},ht=()=>{try{localStorage.removeItem(ot)}catch{}W.current=null,Z([Le])},gt=[{label:"ðŸ”¥ Ofertas",value:"Mostrame ofertas"},{label:"â­ Destacados",value:"Lo mÃ¡s vendido"},{label:"ðŸŽ« Cupones",value:"TenÃ©s cupones?"},{label:"ðŸšš EnvÃ­o",value:"CÃ³mo es el envÃ­o?"},{label:"ðŸ’³ Pagos",value:"QuÃ© medios de pago hay?"},{label:"ðŸ“‚ CategorÃ­as",value:"QuÃ© categorÃ­as tenÃ©s?"}];return G?s.default.createElement("div",{"data-testid":"sustia-root",className:`store-sustia-root fixed right-4 bottom-[calc(1rem+env(safe-area-inset-bottom))] sm:bottom-4 z-[9999] flex flex-col items-end pointer-events-none ${ne?"store-sustia-root-with-wa":""}`},X&&s.default.createElement("div",{className:"sustia-chat-open backdrop-blur-2xl border rounded-[2rem] w-[calc(100vw-2rem)] sm:w-80 md:w-96 h-[min(600px,80dvh)] flex flex-col mb-4 overflow-hidden font-sans pointer-events-auto relative mr-0 sm:mr-0",style:{backgroundColor:"rgba(15,15,15,0.95)",borderColor:O(.15),boxShadow:`0 20px 50px rgba(0,0,0,0.5), 0 0 30px ${O(.08)}`}},s.default.createElement("div",{className:"p-5 flex justify-between items-center relative z-10",style:{background:`linear-gradient(135deg, ${z}, ${me})`}},s.default.createElement("div",{className:"flex items-center gap-3"},s.default.createElement("div",{className:"p-1 bg-white/20 rounded-full backdrop-blur-md overflow-hidden border border-white/30"},s.default.createElement("img",{src:Me,className:"w-9 h-9 object-cover rounded-full",alt:"SustIA"})),s.default.createElement("div",null,s.default.createElement("h3",{className:"font-black text-white text-sm tracking-tight"},"Asistente Virtual"),s.default.createElement("p",{className:"text-[10px] text-white/90 font-bold flex items-center gap-1.5"},s.default.createElement("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",style:{boxShadow:"0 0 8px rgba(74,222,128,0.8)"}}),"En lÃ­nea"))),s.default.createElement("div",{className:"flex items-center gap-1"},s.default.createElement("button",{onClick:ht,className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-all duration-200 active:scale-90",title:"Limpiar chat"},s.default.createElement(et,{className:"w-5 h-5"})),s.default.createElement("button",{onClick:()=>Pe(!1),className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-all duration-200 active:scale-90",title:"Cerrar"},s.default.createElement(Se,{className:"w-5 h-5"})))),s.default.createElement("div",{className:`px-4 py-2 border-b ${de?"bg-[#111] border-white/5":"bg-slate-50 border-slate-200"}`},s.default.createElement("div",{className:"flex gap-2 overflow-x-auto pb-1 custom-scrollbar"},gt.map(a=>s.default.createElement("button",{key:a.label,type:"button","data-testid":`quick-action-${a.label.toLowerCase()}`,onClick:()=>ft(a.value),className:`sustia-quick-btn shrink-0 px-3 py-1.5 rounded-full text-[11px] font-bold border ${de?"border-white/10 bg-[#1a1a1a] text-white hover:bg-[#222]":"border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,style:{"--hover-border":z}},s.default.createElement("span",{className:de?"text-white":"text-slate-800"},a.label))))),s.default.createElement("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 custom-scrollbar relative",style:{backgroundColor:"rgba(10,10,10,0.5)"}},ee.map((a,n)=>s.default.createElement("div",{key:n,className:`flex flex-col ${a.role==="client"?"items-end sustia-msg-user":"items-start sustia-msg-bot"}`},s.default.createElement("div",{className:`max-w-[85%] p-4 rounded-2xl text-[13px] leading-relaxed shadow-lg ${a.role==="client"?"text-white rounded-tr-none border border-white/10":"bg-[#1a1a1a] text-slate-200 rounded-tl-none border border-white/5"}`,style:a.role==="client"?{background:`linear-gradient(135deg, ${z}, ${me})`}:void 0},a.text&&a.text.includes("[WSP_BUTTON]")?s.default.createElement(s.default.Fragment,null,a.text.split("[WSP_BUTTON]").map((t,c,p)=>s.default.createElement(s.default.Fragment,{key:c},t&&s.default.createElement("p",{className:"whitespace-pre-wrap"},tt(t)),c<p.length-1&&u?.whatsappLink&&s.default.createElement("a",{href:u.whatsappLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-2 mb-1 px-4 py-2 bg-green-600 hover:bg-green-500 text-white text-xs font-bold rounded-full transition-all shadow-lg shadow-green-900/30 active:scale-95"},s.default.createElement($t,{className:"w-4 h-4"}),"Ir a WhatsApp")))):s.default.createElement("p",{className:"whitespace-pre-wrap"},tt(a.text))),a.products&&a.products.length>0&&s.default.createElement("div",{className:"mt-3 flex gap-3 overflow-x-auto pb-2 w-full custom-scrollbar pl-1 snap-x"},a.products.map((t,c)=>s.default.createElement(Nt,{key:t.id,product:t,idx:c,accentColor:z,onAdd:(p,y)=>{K(p,y),Z(l=>[...l,{role:"model",text:`âœ… Agregado ${y}x ${p.name} al carrito! ðŸ›’`}])}}))))),Te&&s.default.createElement("div",{className:"flex justify-start sustia-msg-bot"},s.default.createElement("div",{className:"bg-[#1a1a1a] p-3 rounded-2xl rounded-bl-none border border-white/5 flex gap-1.5 items-center"},s.default.createElement("span",{className:"sustia-dot w-2 h-2 rounded-full",style:{backgroundColor:z,animationDelay:"0s"}}),s.default.createElement("span",{className:"sustia-dot w-2 h-2 rounded-full",style:{backgroundColor:z,opacity:.7,animationDelay:"0.15s"}}),s.default.createElement("span",{className:"sustia-dot w-2 h-2 rounded-full",style:{backgroundColor:z,opacity:.4,animationDelay:"0.3s"}}))),s.default.createElement("div",{ref:De})),s.default.createElement("div",{className:"p-3 border-t relative z-0",style:{backgroundColor:"#0a0a0a",borderColor:O(.15)}},s.default.createElement("form",{onSubmit:a=>{a.preventDefault(),pt()},className:"flex gap-2 items-center"},s.default.createElement("input",{className:"flex-1 bg-[#1a1a1a] border border-white/10 rounded-full px-4 py-2.5 text-sm text-white outline-none transition-all placeholder:text-slate-600",placeholder:"Escribe aquÃ­...",value:fe,onChange:a=>ze(a.target.value),style:{"--focus-color":O(.5)},onFocus:a=>a.target.style.borderColor=O(.5),onBlur:a=>a.target.style.borderColor="rgba(255,255,255,0.1)"}),s.default.createElement("button",{type:"submit",className:"p-2.5 text-white rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed active:scale-90 hover:brightness-110",style:{backgroundColor:z,boxShadow:`0 4px 12px ${O(.25)}`},disabled:Te||!fe.trim()},s.default.createElement(Re,{className:"w-4 h-4"}))))),s.default.createElement("button",{onClick:()=>Pe(!X),"data-testid":"sustia-launcher","aria-label":X?"Cerrar chat de SustIA":"Abrir chat de SustIA",className:"sustia-fab store-sustia-launcher-fab pointer-events-auto w-14 h-14 rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 group relative z-50",style:{background:`linear-gradient(135deg, ${z}, ${me})`,boxShadow:`0 0 20px ${O(.4)}`}},X?s.default.createElement(Se,{className:"w-6 h-6 text-white"}):s.default.createElement("div",{className:"w-full h-full p-1"},s.default.createElement("img",{src:Me,className:"w-full h-full object-cover rounded-full opacity-95 group-hover:scale-110 transition-transform duration-300",alt:"SustIA"})),!X&&s.default.createElement(s.default.Fragment,null,s.default.createElement("span",{className:"sustia-pulse-ring absolute inset-0 rounded-full",style:{border:`2px solid ${O(.4)}`}}),s.default.createElement("span",{className:"absolute -top-1 -right-1 flex h-4 w-4"},s.default.createElement("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full opacity-75",style:{backgroundColor:z}}),s.default.createElement("span",{className:"relative inline-flex rounded-full h-4 w-4 border border-black",style:{backgroundColor:z}}))))):null},(u,C)=>!(u.settings?.subscriptionPlan!==C.settings?.subscriptionPlan||u.settings?.primaryColor!==C.settings?.primaryColor||u.settings?.storeName!==C.settings?.storeName||u.settings?.botImage!==C.settings?.botImage||u.hasFloatingWhatsapp!==C.hasFloatingWhatsapp||u.products!==C.products||u.coupons!==C.coupons)),qt=kt;export{qt as default};
//# sourceMappingURL=SustIABot-KLESF4YV.js.map
