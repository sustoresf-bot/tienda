import t,{useState as T,useEffect as Q,useRef as D,useMemo as Ne}from"react";import{Send as ke,X as le,Trash2 as $e,Plus as Ae}from"lucide-react";var Se=({product:r,onAdd:y})=>{let[w,N]=T(1),z=r.basePrice*(1-(r.discount||0)/100);return t.createElement("div",{className:"min-w-[200px] max-w-[200px] bg-[#1a1a1a] rounded-2xl border border-white/5 overflow-hidden flex flex-col group snap-center"},t.createElement("div",{className:"relative h-28 bg-white p-2"},t.createElement("img",{src:r.image,className:"w-full h-full object-contain group-hover:scale-110 transition duration-500",alt:r.name}),r.discount>0&&t.createElement("div",{className:"absolute top-2 left-2 bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg"},"-",r.discount,"%")),t.createElement("div",{className:"p-3 flex-1 flex flex-col"},t.createElement("h4",{className:"text-white font-bold text-xs line-clamp-2 mb-2 leading-tight h-8"},r.name),t.createElement("div",{className:"mt-auto"},t.createElement("div",{className:"flex items-center gap-2 mb-3"},t.createElement("span",{className:"text-yellow-500 font-black text-sm"},"$",Math.round(z).toLocaleString()),r.discount>0&&t.createElement("span",{className:"text-slate-500 text-[10px] line-through"},"$",r.basePrice.toLocaleString())),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("div",{className:"flex bg-black/40 rounded-lg border border-white/5 overflow-hidden"},t.createElement("button",{onClick:()=>N(Math.max(1,w-1)),className:"px-2 py-1 text-slate-400 hover:text-white hover:bg-white/5 transition"},"-"),t.createElement("span",{className:"px-2 py-1 text-xs text-white font-bold min-w-[24px] text-center"},w),t.createElement("button",{onClick:()=>N(Math.min(99,w+1)),className:"px-2 py-1 text-slate-400 hover:text-white hover:bg-white/5 transition"},"+")),t.createElement("button",{onClick:()=>y(r,w),className:"flex-1 bg-yellow-600 hover:bg-yellow-500 text-white py-1.5 rounded-lg text-[10px] font-black transition flex items-center justify-center gap-1 shadow-lg shadow-yellow-900/20"},t.createElement(Ae,{className:"w-3 h-3"})," LISTO")))))},Te=t.memo(({settings:r,products:y,addToCart:w,controlPanel:N,coupons:z,appId:ce})=>{if(!(()=>{try{return String(window.location.href||"").includes("sustia=1")?!0:new URLSearchParams(window.location.search).get("sustia")==="1"}catch{return!1}})()&&r?.subscriptionPlan!=="premium")return null;let[P,Z]=T(!1),[R,ee]=T(!1),ue=r?.botImage||"sustia-ai-v2.jpg",de=`sustore_sustia_chat_${ce}`,te={role:"model",text:"Â¡Hola! Soy SustIA ðŸ¤–, tu asistente personal. Â¿Buscas algo especial hoy? Puedo verificar stock y agregar productos a tu carrito."},[E,C]=T([te]),[O,ae]=T(""),[oe,re]=T(!1),[se,j]=T(null),ne=D(null),ie=D(E),H=D(!1),V=D(null),U=D(!0),v=Array.isArray(y)?y:[],me=Array.isArray(z)?z:[],pe=!!r?.aiAssistant?.enabled;Q(()=>{let a=()=>{try{ee(document?.documentElement?.classList?.contains("dark-mode")===!0)}catch{ee(!1)}};a();let s;try{s=new MutationObserver(()=>a()),document?.documentElement&&s.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}catch{}return()=>{try{s?.disconnect?.()}catch{}}},[]);let k=a=>a==null?"":String(a).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),fe=a=>{let s=k(a);if(!s)return[];let o=s.split(/[\s,.;:!?/()\\[\]{}"â€œâ€'â€™\-+*_]+/).filter(Boolean),i=new Set(["el","la","los","las","un","una","unos","unas","de","del","en","con","sin","para","por","a","al","que","como","cual","cuales","donde","cuando","quien","quienes","hola","buenas","buenos","dia","dias","tardes","noches","busco","buscar","tenes","tienes","precio","vale","cuesta","quiero","necesito","hay","me","te","mi","mis","tu","tus","agrega","agregar","agregame","agregalo","sumar","sumame","poner","pone","comprar","compralo","llevo","carrito","bolsa","cesta","mas","menos","muy","super","re"]);return o.filter(l=>l.length>1&&!i.has(l)&&!/^\d+$/.test(l))},W=(a,s)=>{if(!a)return null;let o=parseFloat(String(a).replace(",","."));return Number.isFinite(o)?s.includes(`${a}k`)||s.includes(`${a} k`)||s.includes(`${a}mil`)||s.includes(`${a} mil`)?o*1e3:o:null},he=a=>{let s=k(a),o=s.match(/\b(?:x|por)\s*(\d{1,3})\b/);if(o)return Math.max(1,Math.min(99,parseInt(o[1],10)));let i=s.match(/\b(\d{1,3})\s*(?:u|ud|uds|unidad|unidades|pcs|piezas)\b/);if(i)return Math.max(1,Math.min(99,parseInt(i[1],10)));let l=s.match(/\b(\d{1,2})\b/);return l&&s.match(/\b(agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|quiero|llevo|comprar)\b/)?Math.max(1,Math.min(99,parseInt(l[1],10))):1},q=a=>{let s=[];return Array.isArray(a?.categories)&&s.push(...a.categories),typeof a?.category=="string"&&a.category.trim()&&s.push(a.category),s.filter(Boolean).map(o=>String(o).trim()).filter(Boolean)},B=a=>{let s=Number(a?.basePrice)||0,o=Number(a?.discount)||0;return s*(1-o/100)},be=Ne(()=>{let a=r?.storeName?String(r.storeName):"",s=r?.aboutUsText?String(r.aboutUsText):"",o=!!r?.shippingDelivery?.enabled,i=!!r?.shippingPickup?.enabled,l=Number(r?.shippingDelivery?.fee)||0,f=Number(r?.shippingDelivery?.freeAbove)||0,u=r?.shippingPickup?.address||"",m=[];i&&m.push(`Retiro en local: ${u||"a coordinar"}.`),o&&(f>0?m.push(`EnvÃ­o a domicilio: $${l.toLocaleString()} (gratis desde $${f.toLocaleString()}).`):m.push(`EnvÃ­o a domicilio: $${l.toLocaleString()}.`));let g=!!r?.paymentMercadoPago?.enabled,L=!!r?.paymentTransfer?.enabled,x=!!r?.paymentCash&&i,$=[];g&&$.push("Tarjeta (Mercado Pago)"),L&&$.push("Transferencia"),x&&$.push("Efectivo (solo retiro en local)");let A=[...new Set([...Array.isArray(r?.categories)?r.categories:[],...v.flatMap(c=>q(c))])].map(c=>String(c).trim()).filter(Boolean).slice(0,20),S=v.filter(c=>c&&(Number(c.stock)||0)>0&&c.isActive!==!1).map(c=>({name:String(c.name||"").trim(),price:B(c),discount:Number(c.discount)||0,featured:!!c.isFeatured,cats:q(c).slice(0,2).join(", ")})).filter(c=>c.name).sort((c,M)=>M.discount-c.discount||Number(M.featured)-Number(c.featured)||c.price-M.price).slice(0,25).map(c=>`${c.name} â€” $${Math.round(c.price).toLocaleString()}${c.cats?` â€” ${c.cats}`:""}`);return{storeName:a,aboutUsText:s,shipping:m.join(" "),payments:$.join(", "),categories:A,productHints:S}},[r,v]),ge=async({userText:a,history:s,signal:o})=>{let i=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userText:a,messages:Array.isArray(s)?s:[],context:be}),signal:o}),l=await i.json().catch(()=>({}));if(!i.ok)throw new Error(l?.error||"ai_error");if(!l?.text||typeof l.text!="string")throw new Error("ai_invalid");return{text:l.text}};Q(()=>{ne.current?.scrollIntoView({behavior:"smooth"})},[E,P]),Q(()=>{ie.current=E},[E]),Q(()=>()=>{U.current=!1},[]);let K=(a,s)=>{if(!s||typeof s!="string"||!a||typeof a!="string")return!1;let o=k(a),i=k(s);if(o.includes(i))return!0;let l=0,f=-1;for(let u of i){let m=o.indexOf(u,f+1);m>-1&&(l++,f=m)}return l/i.length>.75},xe=async(a,s)=>{await new Promise(e=>setTimeout(e,800));let o=k(a),i=he(o);if(o.length<=1)return{text:"Te leÃ­, pero me falta info ðŸ˜Š. Â¿QuÃ© estÃ¡s buscando? (ej: 'auriculares', 'zapatillas', 'envÃ­o', 'pagos')"};if(o.match(/\b(hola|holas|buen dia|buenos dias|buenas tardes|buenas noches|buenas|hello|hi|hey|que tal|como estas|como va|todo bien)\b/))return{text:"Â¡Hola! ðŸ‘‹ Â¿QuÃ© querÃ©s hacer? PodÃ©s pedirme productos, ofertas, cupones, envÃ­o, pagos o que agregue algo al carrito."};if(o.match(/\b(quien sos|que sos|que haces|sos real|sos un bot|asistente)\b/))return{text:`Soy SustIA${r?.storeName?` de **${r.storeName}**`:""}. Puedo ayudarte a encontrar productos, ver ofertas/cupones y armar el carrito mÃ¡s rÃ¡pido.`};if(o.match(/\b(categorias|categoria|rubros|rubro|secciones)\b/)){let e=[...new Set(v.flatMap(d=>q(d)))],n=[...new Set([...Array.isArray(r?.categories)?r.categories:[],...e])].map(d=>String(d).trim()).filter(Boolean);return n.length===0?{text:"TodavÃ­a no tengo categorÃ­as configuradas. Decime quÃ© estÃ¡s buscando y lo resuelvo igual."}:{text:`Tenemos estas categorÃ­as:

${n.slice(0,10).map(d=>`- ${d}`).join(`
`)}

Decime cuÃ¡l te interesa y te muestro opciones.`}}if(o.match(/\b(sobre|info|informacion|quienes somos|about)\b/)){let e=r?.aboutUsText||"";return e.trim()?{text:e.trim()}:{text:"Esta tienda todavÃ­a no cargÃ³ su secciÃ³n â€œSobre nosotrosâ€. Â¿QuerÃ©s que te ayude a encontrar un producto?"}}if(N){if(o.match(/modo\s*(?:oscuro|noche|dark)/))return N.setDarkMode(!0),{text:"He activado el modo oscuro ðŸŒ™. Â¿Mejor para tus ojos?"};if(o.match(/modo\s*(?:claro|dia|light)/))return N.setDarkMode(!1),{text:"He activado el modo claro â˜€ï¸."};if(o.match(/(?:ver|abrir|ir al)\s*(?:carrito|bolsa|cesta)/))return N.openCart(),{text:"Abriendo tu carrito de compras... ðŸ›’"}}if(o.match(/\b(envio|envios|entrega|delivery|domicilio|retiro|retirar|local|pickup)\b/)){let e=!!r?.shippingDelivery?.enabled,n=!!r?.shippingPickup?.enabled,p=Number(r?.shippingDelivery?.fee)||0,d=Number(r?.shippingDelivery?.freeAbove)||0,h=r?.shippingPickup?.address||"",b=[];return n&&b.push(`ðŸ“ Retiro en local: ${h?`**${h}**`:"a coordinar"}.`),e&&(d>0?b.push(`ðŸšš EnvÃ­o a domicilio: $${p.toLocaleString()} (gratis desde $${d.toLocaleString()}).`):b.push(`ðŸšš EnvÃ­o a domicilio: $${p.toLocaleString()}.`)),!n&&!e&&b.push("TodavÃ­a no tengo configurado el mÃ©todo de entrega para esta tienda."),b.push("Si me decÃ­s tu ciudad/zona, te digo lo mejor para vos."),{text:b.join(`
`)}}if(o.match(/\b(pago|pagos|tarjeta|mercado\s*pago|transferencia|cbu|alias|efectivo)\b/)){let e=!!r?.paymentMercadoPago?.enabled,n=!!r?.paymentTransfer?.enabled,p=!!r?.paymentCash&&!!r?.shippingPickup?.enabled,d=n&&o.match(/\b(alias|cbu|transferencia)\b/),h=[];if(e&&h.push("ðŸ’³ Tarjeta (Mercado Pago)"),n&&h.push("ðŸ¦ Transferencia"),p&&h.push("ðŸ’µ Efectivo (solo retiro en local)"),h.length===0)return{text:"TodavÃ­a no tengo mÃ©todos de pago configurados para esta tienda. Si querÃ©s, te paso WhatsApp para coordinar."};if(d){let b=r?.paymentTransfer?.holderName?String(r.paymentTransfer.holderName).trim():"",G=r?.paymentTransfer?.alias?String(r.paymentTransfer.alias).trim():"",Y=r?.paymentTransfer?.cbu?String(r.paymentTransfer.cbu).trim():"",_=["Para transferir, usÃ¡ estos datos:"];return b&&_.push(`- Titular: ${b}`),G&&_.push(`- Alias: ${G}`),Y&&_.push(`- CBU: ${Y}`),!b&&!G&&!Y&&_.push("- AÃºn no estÃ¡n cargados los datos de transferencia para esta tienda."),{text:_.join(`
`)}}return{text:`PodÃ©s pagar con:

${h.map(b=>`- ${b}`).join(`
`)}

Â¿Con cuÃ¡l preferÃ­s?`}}if(o.match(/\b(ayuda|soporte|contacto|human|persona|asesor)\b/))return r?.whatsappLink?{text:`Claro. Si necesitas asistencia personalizada con un humano ðŸ§‘â€ðŸ’», escrÃ­benos a nuestro WhatsApp: ${r.whatsappLink} ðŸ“²`}:{text:"Estoy diseÃ±ado para ayudarte a encontrar productos las 24hs. ðŸ¤– Â¿Buscas algo en especÃ­fico?"};if(o.match(/\b(descuento|promo|cupon|oferta|codigo|rebaja)\b/)){let e=me.filter(p=>p?.active),n=v.filter(p=>(Number(p?.discount)||0)>0&&(Number(p?.stock)||0)>0);return e.length>0?{text:`Â¡SÃ­! Tenemos estos cupones disponibles para ti:

${e.filter(d=>d?.code).map(d=>`ðŸŽ« **${d.code}** (${d.discountType==="percentage"?d.value+"%":"$"+d.value} OFF)`).join(`
`)}

Â¡Ãšsalos al finalizar tu compra! ðŸ›’`}:n.length>0?(j({type:"show_deals",data:n.sort(()=>.5-Math.random()).slice(0,5)}),{text:`No tengo cÃ³digos de cupÃ³n activos ahora, pero sÃ­ tenemos **${n.length}** productos con descuento. Â¿QuerÃ©s que te muestre los mejores? ðŸ·ï¸`}):{text:"Por el momento no tengo cÃ³digos promocionales activos, pero nuestros precios son los mejores del mercado. ðŸ˜‰"}}if(se){if(o.match(/\b(si|claro|dale|bueno|yes|por favor|obvio)\b/)){let e=se;if(j(null),e.type==="suggest_cross_sell")return{text:"Â¡Excelente! Mira estas oportunidades que seleccionÃ© para ti: ðŸ”¥",products:e.data};if(e.type==="show_deals")return{text:"Listo. Estas son algunas ofertas que valen la pena ahora mismo:",products:e.data}}else if(o.match(/\b(no|gracias|paso|cancelar|asi esta bien)\b/))return j(null),{text:"Entendido. Â¿Necesitas ayuda con algo mÃ¡s? ðŸ˜Š"}}let l=o.match(/(?:mas|muy|super)\s*(?:barato|economico|bajo)|oferta|menos|mas\s*economico/),f=o.match(/(?:mas|muy|super)\s*(?:caro|mejor|calidad|top|premium)|costoso|lujo/),u=o.match(/(?:agrega|agregar|agregame|sum[aÃ¡]|pone|poner|met[eÃ©]|comprar|quiero|dame|carrito|llevo|lo quiero)/),m=0,g=1/0,L=o.match(/(?:menos|menor|bajo)\s*(?:de|a|que)?\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(L){let e=W(L[1],o);e!==null&&(g=e)}let x=o.match(/entre\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?\s*y\s*\$?\s*(\d+(?:[.,]\d+)?)(?:\s*(?:k|mil))?/);if(x){let e=W(x[1],o),n=W(x[2],o);e!==null&&(m=e),n!==null&&(g=n)}let A=[...new Set(v.flatMap(e=>q(e)))].find(e=>K(e,o)||K(o,e)),S=A?A.toLowerCase():null,c=new Map([["celu","celular"],["cel","celular"],["tele","televisor"],["tv","televisor"],["compu","computadora"],["notebook","laptop"],["auris","auriculares"],["zapas","zapatillas"],["remera","camiseta"],["remeras","camisetas"]]),M=fe(o).flatMap(e=>{let n=c.get(e);return n?[e,n]:[e]});if(M.length===0&&!S&&!l&&!f&&!u)return{text:"Â¿Me decÃ­s quÃ© producto o categorÃ­a querÃ©s ver? Si querÃ©s, tambiÃ©n podÃ©s preguntar por 'envÃ­o', 'pagos' o 'cupones'."};let I=v.filter(e=>(Number(e?.stock)||0)>0&&e?.isActive!==!1);I=I.filter(e=>{let n=B(e);return n>=m&&n<=g}),S&&(I=I.filter(e=>q(e).some(n=>n.toLowerCase()===S)));let F=I.map(e=>{let n=0,p=k(e.name),d=k(e.description);return M.forEach(h=>{p.includes(h)?n+=10:K(p,h)&&(n+=5),d.includes(h)&&(n+=2)}),e.isFeatured&&(n+=5),e.discount>0&&(n+=3),l&&(n+=1/(B(e)||1)*1e4),f&&(n+=B(e)/100),{product:e,score:n}}).filter(e=>e.score>0).sort((e,n)=>n.score-e.score).slice(0,5).map(e=>e.product);if(F.length===0)return{text:"No encontrÃ© exactamente lo que buscÃ¡s, pero probando con otra palabra o viendo nuestras categorÃ­as seguro lo hallamos. ðŸ”Ž"};if(u&&F.length>0){let e=F[0];w(e,i);let n=v.filter(p=>p.id!==e.id&&(Number(p.stock)||0)>0&&p.isActive!==!1).sort(()=>.5-Math.random()).slice(0,3);return n.length>0?(j({type:"suggest_cross_sell",data:n}),{text:`Â¡Listo! AgreguÃ© **${i}x ${e.name}** a tu carrito. ðŸ›’

Â¿Te gustarÃ­a ver algunos productos destacados para complementar tu compra? ðŸ‘€`,products:[e]}):{text:`Â¡Listo! AgreguÃ© **${i}x ${e.name}** a tu carrito. ðŸ›’ Â¿Algo mÃ¡s?`,products:[e]}}let X="EncontrÃ© estas opciones. Â¿QuerÃ©s que te muestre mÃ¡s o me decÃ­s un presupuesto?";return S&&(X=`EncontrÃ© esto en la categorÃ­a ${S}:`),l&&(X="Las opciones mÃ¡s econÃ³micas:"),{text:X,products:F}},ve=async(a,s)=>{let o=null,i=new Promise((l,f)=>{o=setTimeout(()=>f(new Error("timeout")),s)});try{return await Promise.race([a,i])}finally{o&&clearTimeout(o)}},J=async(a,s={})=>{let o=!!s.alreadyAddedUser,i=String(a||"").trim().slice(0,300);if(!i)return;if(H.current){if(!o){let u={role:"client",text:i};C(m=>[...m,u])}V.current={text:i,alreadyAddedUser:!0};return}H.current=!0,ae("");let l=o?null:{role:"client",text:i},f=[...ie.current||[],...l?[l]:[]];l&&C(u=>[...u,l]),re(!0);try{let u=await ve(xe(i,f),12e3);if(!U.current)return;let m=u?.text&&typeof u.text=="string"?u.text:"PerdÃ³n, tuve un problema procesando eso. Â¿PodÃ©s reformularlo?",g=Array.isArray(u?.products)?u.products:void 0;if(pe&&(!g||g.length===0)&&/no encontr[eÃ©]|no tengo eso|no lo tengo|probando con otra palabra/i.test(m)){let x=new AbortController,$=setTimeout(()=>x.abort(),8500);try{let A=await ge({userText:i,history:f,signal:x.signal});A?.text&&(m=A.text)}catch{}clearTimeout($)}C(x=>[...x,{role:"model",text:m,products:g}])}catch{if(!U.current)return;let m=r?.whatsappLink?`Uy, se me trabÃ³ por un momento. Si querÃ©s, hablÃ¡ por WhatsApp: ${r.whatsappLink}`:"Uy, se me trabÃ³ por un momento. Â¿Probamos de nuevo?";C(g=>[...g,{role:"model",text:m}])}finally{U.current&&re(!1),H.current=!1;let u=V.current;u&&u.text&&(V.current=null,setTimeout(()=>J(u.text,{alreadyAddedUser:u.alreadyAddedUser===!0}),0))}},ye=async()=>J(O),we=a=>{let s=String(a||"").trim();s&&J(s)};return t.createElement("div",{className:"fixed bottom-4 right-4 z-[9999] flex flex-col items-end pointer-events-none"},P&&t.createElement("div",{className:"bg-[#0f0f0f]/95 backdrop-blur-2xl border border-white/10 rounded-[2rem] w-[calc(100vw-2rem)] sm:w-80 md:w-96 h-[min(600px,80dvh)] shadow-[0_20px_50px_rgba(0,0,0,0.5)] flex flex-col mb-4 animate-fade-up overflow-hidden font-sans pointer-events-auto ring-1 ring-white/10 relative mr-0 sm:mr-0"},t.createElement("div",{className:"bg-gradient-to-r from-yellow-500 to-amber-600 p-5 flex justify-between items-center relative z-10"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("div",{className:"p-1 bg-white/20 rounded-full backdrop-blur-md overflow-hidden border border-white/30"},t.createElement("img",{src:ue,className:"w-9 h-9 object-cover rounded-full",alt:"SustIA"})),t.createElement("div",null,t.createElement("h3",{className:"font-black text-white text-sm tracking-tight"},"SustIA AI"),t.createElement("p",{className:"text-[10px] text-white/90 font-bold flex items-center gap-1.5"},t.createElement("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-[0_0_8px_rgba(74,222,128,0.8)]"}),"En lÃ­nea"))),t.createElement("div",{className:"flex items-center gap-1"},t.createElement("button",{onClick:()=>{try{localStorage.removeItem(de)}catch{}j(null),C([te])},className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Limpiar chat"},t.createElement($e,{className:"w-5 h-5"})),t.createElement("button",{onClick:()=>Z(!1),className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-colors",title:"Cerrar"},t.createElement(le,{className:"w-5 h-5"})))),t.createElement("div",{className:"bg-[#111] px-4 py-2 border-b border-white/5"},t.createElement("div",{className:"flex gap-2 overflow-x-auto pb-1 custom-scrollbar"},[{label:"Ofertas",value:"Mostrame ofertas"},{label:"Cupones",value:"TenÃ©s cupones?"},{label:"EnvÃ­o",value:"CÃ³mo es el envÃ­o?"},{label:"Pagos",value:"QuÃ© medios de pago hay?"},{label:"CategorÃ­as",value:"QuÃ© categorÃ­as tenÃ©s?"},{label:"WhatsApp",value:"Necesito hablar con una persona"}].map(a=>t.createElement("button",{key:a.label,type:"button","data-testid":`quick-action-${a.label.toLowerCase()}`,onClick:()=>{we(a.value)},className:R?"shrink-0 px-3 py-1.5 rounded-full text-[11px] font-bold border border-white/10 bg-[#1a1a1a] text-white hover:bg-[#222] transition":"shrink-0 px-3 py-1.5 rounded-full text-[11px] font-bold border border-slate-200 bg-white text-slate-800 hover:bg-slate-50 transition"},t.createElement("span",{className:R?"text-white":"text-slate-800"},a.label))))),t.createElement("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 bg-[#0a0a0a]/50 custom-scrollbar relative"},E.map((a,s)=>t.createElement("div",{key:s,className:`flex flex-col ${a.role==="client"?"items-end":"items-start"} animate-fade-in`},t.createElement("div",{className:`max-w-[85%] p-4 rounded-2xl text-[13px] leading-relaxed shadow-lg ${a.role==="client"?"bg-gradient-to-br from-yellow-500 to-amber-600 text-white rounded-tr-none border border-white/10":"bg-[#1a1a1a] text-slate-200 rounded-tl-none border border-white/5"}`},t.createElement("p",{className:"whitespace-pre-wrap"},a.text)),a.products&&a.products.length>0&&t.createElement("div",{className:"mt-3 flex gap-3 overflow-x-auto pb-2 w-full custom-scrollbar pl-1 snap-x"},a.products.map(o=>t.createElement(Se,{key:o.id,product:o,onAdd:(i,l)=>{w(i,l),C(f=>[...f,{role:"model",text:`Agregado ${l}x ${i.name} al carrito! ðŸ›’`}])}}))))),oe&&t.createElement("div",{className:"flex justify-start"},t.createElement("div",{className:"bg-[#1a1a1a] p-3 rounded-2xl rounded-bl-none border border-white/5 flex gap-1"},t.createElement("span",{className:"w-1.5 h-1.5 bg-slate-500 rounded-full animate-bounce"}),t.createElement("span",{className:"w-1.5 h-1.5 bg-slate-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),t.createElement("span",{className:"w-1.5 h-1.5 bg-slate-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}))),t.createElement("div",{ref:ne})),t.createElement("div",{className:"p-3 bg-[#0a0a0a] border-t border-white/10 relative z-0"},t.createElement("form",{onSubmit:a=>{a.preventDefault(),ye()},className:"flex gap-2 items-center"},t.createElement("input",{className:"flex-1 bg-[#1a1a1a] border border-white/10 rounded-full px-4 py-2.5 text-sm text-white focus:border-yellow-500/50 outline-none transition placeholder:text-slate-600",placeholder:"Escribe aquÃ­...",value:O,onChange:a=>ae(a.target.value)}),t.createElement("button",{type:"submit",className:"p-2.5 bg-yellow-600 hover:bg-yellow-500 text-white rounded-full transition shadow-lg shadow-yellow-600/20 disabled:opacity-50 disabled:cursor-not-allowed",disabled:oe||!O.trim()},t.createElement(ke,{className:"w-4 h-4"}))))),t.createElement("button",{onClick:()=>Z(!P),className:"pointer-events-auto w-14 h-14 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(234,179,8,0.4)] hover:scale-110 transition-transform group relative z-50"},P?t.createElement(le,{className:"w-6 h-6 text-white"}):t.createElement("div",{className:"w-full h-full p-1"},t.createElement("img",{src:"sustia-ai-v2.jpg",className:"w-full h-full object-cover rounded-full opacity-95 group-hover:scale-110 transition-transform duration-300",alt:"SustIA"})),!P&&t.createElement("span",{className:"absolute -top-1 -right-1 flex h-4 w-4"},t.createElement("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"}),t.createElement("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-yellow-500 border border-black"}))))},(r,y)=>!(r.settings?.subscriptionPlan!==y.settings?.subscriptionPlan||r.products!==y.products)),ze=Te;export{ze as default};
//# sourceMappingURL=SustIABot-6GAD4MIR.js.map
